<!DOCTYPE html>
<html lang="en" data-mode="dark">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Jekyll v4.2.2">
<meta property="og:title" content="Organizing Software">
<meta property="og:locale" content="en">
<meta name="description" content="Misc thoughts on organizing, software, LARP, gender, and everything inbetween.">
<meta property="og:description" content="Misc thoughts on organizing, software, LARP, gender, and everything inbetween.">
<link rel="canonical" href="https://blog.clementsd.dev/posts/page/2/">
<meta property="og:url" content="https://blog.clementsd.dev/posts/page/2/">
<meta property="og:site_name" content="Organizing Software">
<meta property="og:type" content="website">
<link rel="prev" href="https://blog.clementsd.dev/">
<link rel="next" href="https://blog.clementsd.dev/posts/page/3">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="Organizing Software">
<meta name="twitter:site" content="@waterpriciple">
<meta name="google-site-verification" content="-BpbC_xRpOJNCukVnjvY3atv6PDwqfO6PiQj7L3Ztec"> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Misc thoughts on organizing, software, LARP, gender, and everything inbetween.","headline":"Organizing Software","url":"https://blog.clementsd.dev/posts/page/2/"}</script><title> | Organizing Software</title>
<link rel="apple-touch-icon" sizes="180x180" href="/assets/images/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicons/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="192x192" href="/assets/images/favicons/android-chrome-192x192.png">
<link rel="icon" type="image/png" sizes="512x512" href="/assets/images/favicons/android-chrome-512x512.png">
<link rel="manifest" type="application/json" href="/assets/images/favicons/site.webmanifest">
<link rel="shortcut icon" type="image/x-icon" href="/assets/images/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Organizing Software">
<meta name="application-name" content="Organizing Software">
<meta name="msapplication-TileColor" content="#0000ff">
<meta name="theme-color" content="#ffffff">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="dns-prefetch" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
<link rel="preconnect" href="https://ajax.googleapis.com">
<link rel="dns-prefetch" href="https://ajax.googleapis.com">
<link rel="preconnect" href="https://cdn.polyfill.io">
<link rel="dns-prefetch" href="https://cdn.polyfill.io">
<link rel="preconnect" href="https://cdn.jsdelivr.net">
<link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Code+Pro:wght@400;600;700;900&amp;display=swap">
<link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials">
<link rel="dns-prefetch" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous">
<link rel="dns-prefetch" href="https://www.googletagmanager.com">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css">
<link rel="stylesheet" href="/assets/css/style.css"> <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body data-spy="scroll" data-target="#toc" data-topbar-visible="true">
<div id="sidebar" class="d-flex flex-column align-items-end">
<div class="profile-wrapper text-center">
<div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/images/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a>
</div>
<div class="site-title mt-3"> <a href="/">Organizing Software</a>
</div>
<div class="site-subtitle font-italic">Better engineering through engineering</div>
</div>
<ul class="w-100">
<li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a>
</li>
<li class="nav-item"> <a href="/categories" class="nav-link"> <i class="fa-fw fa-duotone fa-bars-staggered ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a>
</li>
<li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fa-duotone fa-hashtag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a>
</li>
<li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fa-duotone fa-box-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a>
</li>
<li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fa-duotone fa-circle-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a>
</li>
</ul>
<div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/dclements" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/waterpriciple" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="/feed.xml" aria-label="rss"> <i class="fas fa-rss"></i> </a> <a href="https://www.linkedin.com/in/dhclements/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://hrafna.itch.io" aria-label="itch" target="_blank" rel="noopener"> <i class="fab fa-itch-io"></i> </a>
</div>
</div>
<div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span></span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Home-custom</div>
<i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel">Cancel</span>
</div></div>
<div id="main-wrapper">
<div id="main">
<div class="row">
<div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">
<h1> <a href="/categories/organizing/politics/posts/roe-v-wade">Next Steps</a>
</h1>
<div class="post-content">
<blockquote>
<p>"We hold that Roe and Casey must be overruled," Justice Alito writes in an initial majority draft circulated inside the court.</p>
<cite><a class="citation" href="#gerstein-2022">[1]</a></cite>
</blockquote>
<p>When I read those words my heart dropped into my stomach. I knew this was coming, even in this term, and still I felt my entire body chill.</p>
<p>The news is terrifying right now. Knowing that it is coming and seeing it in reality are always different things, and seeing the text of this opinion I thought of all of the people who will be hurt and how many lives with be affected when this decision goes into effect.</p>
<p>Despair is a natural response, but I wanted to compile some thoughts from various sources on what people can actually do in this moment. What will be <em>effective</em> to do right now. It’s part of my way of coping, of understanding where I need to put my feet next and to understand how the situation has evolved over time.</p>
<p>I don’t claim to have the answers, and I write this as much for myself as anyone. What I will say, however, is that the paths forward all involve organizing.</p>
<h2 id="being-effective">
<span class="mr-2">Being Effective</span><a href="#being-effective" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h2>
<blockquote>
<p>…stop engaging in parades, and start disrupting the operation of power.</p>
<cite><a class="citation" href="#mclaughlin-2022">[2]</a></cite>
</blockquote>
<p>Note first: Almost nothing here is effective unless you have done the ground level organizing, and that should almost always start with people who are already doing it, if they exist (and they often do).</p>
<h3 id="breaking-the-law">
<span class="mr-2">Breaking the Law</span><a href="#breaking-the-law" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h3>
<p>Determine if you are willing to break the law as part of your action, in what ways, and on what timeline. Think <em>very</em> careflly about this.</p>
<blockquote class="twitter-tweet" data-lang="en" data-theme="dark">
<p lang="en" dir="ltr">Tonight‘s abject panic makes it clear that people aren’t ready for what’s about to happen. <br><br>Get ready. <br><br>Get your affairs in order. <br><br>Figure out whether or not you’re willing to break the law to help a friend get an abortion and how far you’re willing to go. <a href="https://twitter.com/hashtag/RoeVWade?src=hash&ref_src=twsrc%5Etfw">#RoeVWade</a></p>— ⚓️Imani Two-Kitchens Gandy⚓️ (@AngryBlackLady) <a href="https://twitter.com/AngryBlackLady/status/1521315143002603521?ref_src=twsrc%5Etfw">May 3, 2022</a>
</blockquote>
<p>If you haven’t already then talk this position over with your family and be prepared to make some hard choices in the future here. Think about it, think about what you are willing to do, and think about the consequences you are willing to endure. Especially if you come from a place of privilege, meaning that for you such thinking is unusual, spend some serious time with the question of where you land on this.</p>
<p>Remember:</p>
<blockquote>
<p><span>You law abiding citizens, come listen to this song<br>Laws were made by people, and people can be wrong<br>Once <a href="https://en.wikipedia.org/wiki/Commonwealth_v._Pullis">unions were against the law</a>, but <a href="https://en.wikipedia.org/wiki/Dred_Scott_v._Sandford">slavery was fine</a><br><a href="https://en.wikipedia.org/wiki/Women%27s_suffrage_in_the_United_States">Women were denied the vote</a> and <a href="https://laborcenter.uiowa.edu/special-projects/child-labor-public-education-project/about-child-labor/child-labor-us-history">children worked the mine</a><br>The more you study history the less you can deny it<br>A rotten law stays on the books til folks like us defy it</span></p>
<cite><a class="citation" href="#feeney-1969">[3]</a></cite>
</blockquote>
<p>I do not, here, mean “talk about what other people should do.” This is about <em>your</em> position. Then talk to others who have already been working on this problem.</p>
<h3 id="understand-where-you-live">
<span class="mr-2">Understand Where You Live</span><a href="#understand-where-you-live" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h3>
<p>With the repeal of Roe, we will get to a hodgepodge of laws through the US (At least until the <a href="https://thehill.com/opinion/campaign/3481669-republicans-calculated-quiet-on-nationwide-abortion-ban-will-vanish-if-they-control-congress/">Republicans gain control of the House, Senate, and Presidency again</a>).</p>
<p>For example, in Colorado there is the <a href="https://leg.colorado.gov/bills/hb22-1279">Reproductive Health Equity Act</a> in force, a blue <a href="https://en.wikipedia.org/wiki/Colorado_General_Assembly">general assembly</a>, a blue <a href="https://en.wikipedia.org/wiki/Jared_Polis">governor</a>.</p>
<p>Broadly, States fall into one of four categories (borrowing from the <a href="https://reproductiverights.org/maps/what-if-roe-fell/">Center for Reproductive Rights</a>):</p>
<ol>
<li>Welcoming. Places with strong protections (constitutional or statutory) and few restrictions.</li>
<li>Protected. They lack the stronger protections or maybe have some additional restrictions, but safe abortions are readily available and likely to remain so.</li>
<li>Not protected. Places where it is only grudgingly legal, but which lack enjoined laws or so-called “trigger laws.”</li>
<li>Hostile. Active antagonism with trigger laws or enjoined laws that will go into force almost immediately.</li>
</ol>
<p>But the details <em>matter</em> and there’s <a href="https://en.wikipedia.org/wiki/Abortion_in_the_United_States_by_state">tremendous state level variance even within each of the categories</a>. As a result you will often find different groups will rate places differently at the edges depending on how much, e.g., they look at <span class="hoverover" data-toggle="tooltip" data-placemet="top" title="Targeted Regulation of Abortion Providers">TRAP</span> laws or whether they consider a court decision binding.</p>
<p>Fundamentally, there are four states (and DC) that protect abortion throughout the pregnancy. There are sixteen states that protect it up to the point of viability. Some of those are statutory protections, some of them are constitutional protections, and sometimes they have other restrictions (like TRAP laws) even though it is generally legal.</p>
<p>Other states are a mixed bag. Some are outright hostile in a lot of ways, but it will remain at least somewhat available so long as the current balance of power in their local government remains where it is.</p>
<p>Know where you are. Know the status of your neighboring states. Know the status of where your friends live. The laws here are a <em>hodgepodge</em> and knowing where your state falls and the <em>specifics</em> of where it falls is important. Some states aren’t likely to restrict it, but also won’t necessarily be good states to drive a friend to either.</p>
<p>Good sources here are the <a href="https://reproductiverights.org/maps/what-if-roe-fell/">Center for Reproductive Rights</a>, the <a href="https://www.guttmacher.org/abortion-rights-supreme-court">Guttmacher institute</a>, and <a href="https://rewirenewsgroup.com/legislative-tracker/">Rewire news group</a>.</p>
<p>Know which is which. Especially as you start working with groups that have been doing this already, it will help give you a baseline understanding of what you are up against.</p>
<h3 id="organize-for-direct-action">
<span class="mr-2">Organize for direct action</span><a href="#organize-for-direct-action" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h3>
<p>I don’t mean parades (what people often call protests).</p>
<p>Organize your workplace, your community, your apartment complex. Get them radicalized and start thinking about what direct action would look like for your group. Start building resources for mutual aid.</p>
<p>What you fight for and how you fight with this depends on what you have organized, but some examples:</p>
<ul>
<li>Get “will not discriminate on the basis of having had an abortion” or equivalent language added to your union contract or tenant agreement.<blockquote class="twitter-tweet" data-lang="en" data-theme="dark">
<p lang="en" dir="ltr">Unions need to start looking at expanding language on preventing employees from getting fired for getting abortions, now.</p>— C.M. Lewis (@thehousered) <a href="https://twitter.com/thehousered/status/1521501534919479296?ref_src=twsrc%5Etfw">May 3, 2022</a>
</blockquote>
</li>
<li>Push your <a href="https://arstechnica.com/gaming/2022/05/bungie-speaks-up-for-fundamental-right-to-reproductive-choice/">company</a> and your <a href="https://www.aclum.org/en/news/labor-unions-support-roe-act-protect-abortion-access">union</a> to vocally support abortion access.</li>
<li>Get your company to <a href="https://www.reuters.com/business/retail-consumer/amazon-reimburse-us-employees-who-travel-treatments-including-abortions-2022-05-02/">support paying travel expenses</a> for those who have to travel for abortions.</li>
<li>
<a href="https://en.wikipedia.org/wiki/Dewey%27s_sit-ins">Shut down businesses that do discriminate here</a>. Your local coffee shop fired someone for getting an abortion? <a href="https://www.npr.org/templates/story/story.php?storyId=91993823">Sit in</a>. Fill every table, lock hands and keep people from entering, turn them into a local pariah.</li>
<li>Push companies to <a href="https://www.nytimes.com/2022/01/06/us/politics/congress-corporate-donations-2020-election-overturn.html">stop supporting republican politicians</a>. Make companies that don’t do this miserable.</li>
<li>Make life miserable for your local legislators (or the US congress or SCOTUS, I won’t judge). Keep pressure up on them.</li>
<li>Use your mutual aid funds to help people get abortions or organize driving/flying people between states.</li>
<li>Come up with other goals that you can reach with various forms of direct action. Get creative and talk it over with your peers, because what you can do is far more expansive than you likely realize.</li>
</ul>
<p>On that note: You can only organize where you are involved. You can’t organize effectively from the outside, so don’t try to “organize the south” unless you <em>live</em> there.</p>
<p>Most of these require that you organize to be effective, so start there. Focus on <em>your</em> apartment complex, <em>your</em> school, <em>your</em> job, <em>your</em> communities. If you are working with organizers of other groups, your job is to listen to them and give them what they ask for.</p>
<p>One thing I was told very early in union organizing is that it doesn’t matter if your coworkers are conservative, if they think they are anti-union, whatever else. They can still be organized.</p>
<p>Ultimately remember though: Direct action is a tool, and as Sara Nelson says, our <em>power</em> comes from <strong>solidarity</strong>. <a class="citation" href="#nelson-2020">[4]</a> The Black Panthers are known for escorting people to register to vote with guns, but they also <a href="https://en.wikipedia.org/wiki/Free_Breakfast_for_Children">made breakfast for children</a>, which is also a form of direct action. Conversely, the Provisional IRA had massive support from the community, for example in the rattling of trash bin lids to signal raids. <a class="citation" href="#owicki-2010">[5]</a></p>
<h3 id="donate-money-and-time-to-groups-that-are-already-working-on-these-problems">
<span class="mr-2">Donate money and time to groups that are already working on these problems</span><a href="#donate-money-and-time-to-groups-that-are-already-working-on-these-problems" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h3>
<p>Try really hard to not reinvent the wheel.</p>
<p>When you are looking to do something, look for people who are already doing that job and help them. Don’t try to create things de novo, focus instead on supporting what already exists.</p>
<p>Usually when people in dominant cultures first become aware of a problem there’s a group that has been working on that exact problem for over 100 years. This is no different.</p>
<p>The first step there is <em>learn who is already working on these problems</em>. Then you can <em>listen</em> to what they need and <em>give</em> it to them.</p>
<h3 id="political-approaches">
<span class="mr-2">Political Approaches</span><a href="#political-approaches" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h3>
<p>Political approaches fall under the category of “don’t put faith in our systems, our systems are at best broken and at worst working exceptionally well at being terrilbe,” but political approaches can create a lot of buffer. Fighting a group of incompetent Democrats who can’t agree is night-and-day from fighting a group of fascist Republicans. Fighting to protect your rights when you have a state-level constitutional amendment in hand is very different than fighting to protect your rights when you don’t have such passed.</p>
<p>So these are effective approaches in some ways, but don’t depend on the government or the political parties to save us. Only we can do that, and many of these are–like the elements above–only effective with good organizing.</p>
<h4 id="push-local-government-around">
<span class="mr-2">Push Local Government Around</span><a href="#push-local-government-around" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h4>
<p>The difference between living in Colorado and living in Texas on these sorts of issues is night and day. So get your local government to pass protections.</p>
<p>Call your city council, your mayor, your local legislator, your local governor.</p>
<p>Make them pledge to pass laws to protect abortion in your state or to provide some degree of sanctuary in your city. Primary them if they won’t do it. If they are all about StAtEs RiGhTs tell them “great, you now have the right to make it legal.” Push them to resist national legislation banning it.</p>
<h4 id="referendums-and-citizen-initiatives">
<span class="mr-2">Referendums and Citizen Initiatives</span><a href="#referendums-and-citizen-initiatives" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h4>
<p>Go through whatever your <a href="https://www.ncsl.org/research/elections-and-campaigns/chart-of-the-initiative-states.aspx">state’s public referendum or citizen’s initiative process is for adding or challenging a constitutional amendment or a law</a>. Learn what your state does for this and what it requires and get on it, and use it to either strike down legislative overreach or to enshrine protections.</p>
<p>Remember that abortion protections up to at least <em>some point</em> are <a href="https://www.pewresearch.org/religion/2022/05/06/americas-abortion-quandary/">popular in the US</a>, so even if you can’t get your legislators on board you can still get protections passed locally.</p>
<p>If you already have it protected, try to amplify those protections. Get it as a constitutional amendment if it isn’t already protected there, make it as <em>explicit</em> an amendment as possible.</p>
<h4 id="push-your-national-legislators">
<span class="mr-2">Push your national legislators</span><a href="#push-your-national-legislators" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h4>
<p>This doesn’t mean yelling “DO SOMETHING” on twitter. Call them. Every day. Fax things to them. Show up at townhalls and yell at them. <a href="https://www.washingtonpost.com/politics/2021/10/04/kyrsten-sinema-bathroom-immigration-reconciliation/">Chase them into bathrooms</a>. Camp out in front of their office or their house. <a href="https://www.cnn.com/2018/10/20/politics/mitch-mcconnell-restaurant-protestors/index.html">Confront them in restaurants</a>. Make your displeasure clear.</p>
<p>They are there to serve you. Remind them of that fact.</p>
<p>Tell them to pass the House’s protection. Tell them to expand the SCOTUS. Tell them to push the President to send abortion providers to federal lands and other suggestions that people like <a href="https://www.thenation.com/article/politics/texas-abortion-fight/">Elie Mystal</a> and Imani Gandy have been talking about.</p>
<p>Do this even if they are conservatives. Make them so miserable that they leave.</p>
<h4 id="vote-blue">
<span class="mr-2">Vote. Blue.</span><a href="#vote-blue" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h4>
<p>Vote and vote blue. Every time. Regardless if they have earned it. Make it so that Manchin is the most conservative member of a 60 member senate. Make sure that the Democrats keep the Presidency. Take your local governorship. Take your local legislator. Take your local dogcatcher and make it blue.</p>
<p>If you don’t want a particular Democrat in the role then primary them, then vote for the Democrat who wins the primary.</p>
<p>Voting blue is insufficient. It is <em>woefully</em> inadequate. Electoralism will <strong>not</strong> save us. <em>But</em> it belongs on this list because you <em>don’t</em> want to be trying to do any of these with a GOP congress and a GOP president, we want to replace Supreme Court members with people who are sympathetic in the long run, not fascists, and a hodgepodge is better than a nationwide ban passed by and enforced by fascists.</p>
<p>The republicans are fascists. Keep them out of power.</p>
<p>On thate note, it is also important to do the work to <strong>improve access to voting</strong>. Make sure everyone is registered to vote. Make sure that they can vote. Protect them in trying to vote. Help them make sure they remain registered to vote and are eligible to vote. Improve turnout in disadvantaged communities with whatever that takes.</p>
<p>I do, incidentally, mean “whatever that takes.”</p>
<h2 id="dont-reinvent-the-wheel-dont-give-up">
<span class="mr-2">Don’t Reinvent the Wheel, Don’t Give Up</span><a href="#dont-reinvent-the-wheel-dont-give-up" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h2>
<blockquote class="twitter-tweet" data-lang="en" data-theme="dark">
<p lang="en" dir="ltr">To begin, welcome to the repro world. I've been an abortion fund volunteer for six years and can confidently say that we've seen this coming. We have prepared for this moment for years and are grounded in reality but nimble enough to evolve with these devastating changes. /1</p>— Sarah (@the_sar_bear88) <a href="https://twitter.com/the_sar_bear88/status/1522611040210542592?ref_src=twsrc%5Etfw">May 6, 2022</a>
</blockquote>
<p>White leftists in particular have a long habit of noticing something and coming to three conclusions:</p>
<ol>
<li>That because they haven’t heard of it previously, no one else has either.</li>
<li>That any other groups that have been working on this have not succeeded due to failures of vision, ethics, or because they haven’t had the white person’s unique insight.</li>
<li>That because something turns out to be hard, it is intractable.</li>
</ol>
<p>It took over a century in the US to stop some of the worst excesses of child labor and we’re still not done nearly a century after <em>that</em>. Women’s suffrage was similarly over 80 years in the making. Let alone the distance between 1619 and 1865.</p>
<p>There are often groups already doing a lot of the things that people think of, saw this coming, and have deep knowledge of the terrain. Connect with them! Help them as much as possible. Remember that we have to be in this for the long haul.</p>
<h2 id="conclusions-consider-where-you-are-and-where-you-need-to-be">
<span class="mr-2">Conclusions: Consider Where You Are, and Where You Need To Be</span><a href="#conclusions-consider-where-you-are-and-where-you-need-to-be" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h2>
<p>In every case, think in terms of <em>where you are</em>, <em>what you want to accomplish</em> and drawing a line to <em>what it will take to accomplish that</em>, and <em>what your escalation is</em> if you fail. As the quote from <a href="https://en.wikipedia.org/wiki/Robert_H._Barrow">Gen. Robert H. Barrow</a> goes:</p>
<blockquote>
<p>Amateurs talk about strategy and tactics. Professionals talk about logistics and sustainability in warfare.</p>
<cite><a class="citation" href="#"></a></cite>
</blockquote>
<p>This means that you can’t just go “we’re going to have a general strike!” then later go “well, no one showed up, so our solution is ADVERTISE HARDER.”</p>
<p>Where you are: Be realistic. Do you have the solidarity and support for a strike? For a general strike? For a sit-in? If not, what will it take to get to that point? How are you going to manage this without burning everyone out?</p>
<p>We must maintain hope and certainty that we <em>will</em> win, and we <strong>also</strong> must maintain a clear-eyed realization of what our position is.</p>
<p>What you are trying to accomplish and what it will take to accomplish that: If you want to, say, raise the minimum wage for everyone, having a walkout at your local whole foods is unlikely to accomplish that. Your escalation if you can’t secure a 15 dollar minimum wage is not “ask for 25 dollars instead” and your escalation path if you can’t get your local store to strike is not “we’ll have a general strike instead!”</p>
<p>Your escalation path should be clear and you should have one, but that means being realistic about where you are and what you <em>can do right now with the resources that you have</em>. It means understanding where you are logistically, and how that situation will evolve.</p>
<p>Learn constantly. Be prepared to fail and to learn from your failures. Be prepared for this to take not just years but generations.</p>
<p>After all, it took generations to get here.</p>
<h2 id="references">
<span class="mr-2">References</span><a href="#references" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h2>
<div class="bibliography">
<p> [1]   <span id="gerstein-2022">J. Gerstein and A. Ward, “Exclusive: Supreme Court has voted to overturn abortion rights, draft opinion shows,” <i>POLITICO</i>. May 2, 2022.</span> [<a href="https://www.politico.com/news/2022/05/02/supreme-court-abortion-draft-opinion-00029473" target="_blank" rel="noreferrer noopener">Online</a>; accessed on 5 May 2022]</p>
<p> [2]   <span id="mclaughlin-2022">E. C. McLaughlin, “A parade is not a protest and other lessons for the looming collapse of our rights,” <i>The Newsletter with ECM</i>. May 7, 2022.</span> [<a href="https://newsletterwithecm.substack.com/p/a-parade-is-not-a-protest" target="_blank" rel="noreferrer noopener">Online</a>; accessed on 9 May 2022]</p>
<p> [3]   <span id="feeney-1969">A. Feeney, “Have you Been To Jail For Justice?,” <i>Original Recordings</i>. 1969.</span> [<a href="https://open.spotify.com/track/5DpunBUz315r2zghXLw30m?si=L5ke_UfTT0iuo7X1rMgv5w" target="_blank" rel="noreferrer noopener">Online</a>; accessed on 9 May 2022]</p>
<p> [4]   <span id="nelson-2020">S. Nelson, “Preface,” in <i>Strike! 50th Anniversary Edition</i>, J. Brecher, Ed. PO Box 23912, Oakland, CA 94623: PM Press, 2020.</span></p>
<p> [5]   <span id="owicki-2010">E. Owicki, “Rattle Away at Your Bin: Women, Community, and Bin Lids in Northern Irish Drama,” <i>Theatre Symposium</i>, vol. 18, pp. 55–56,</span> doi: <a href="https://doi.org/10.1353/tsy.2010.0011" target="_blank" rel="noreferrer noopener">10.1353/tsy.2010.0011</a>. [<a href="https://muse.jhu.edu/article/469182" target="_blank" rel="noreferrer noopener">Online</a>; accessed on 9 May 2022]</p>
</div>
</div>
<div class="post-meta text-muted d-flex"><div class="mr-auto"> <i class="far fa-calendar fa-fw"></i> <em class="timeago" data-ts="1652166000" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" data-capitalize="true"> 2022-05-10 </em> <i class="far fa-clock fa-fw"></i> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2774 words"> <em>15 min</em></span> <i class="far fa-folder-open fa-fw"></i> <span> organizing, politics </span>
</div></div>
<h1> <a href="/categories/technology/programming/posts/root-canal">Project Root Canal: A Story About Fixing a System</a>
</h1>
<div class="post-content">
<p>Years ago I was working on a project that had a sort of “service locator” pattern in it. This is a memory about how it got replaced with dependency injection.</p>
<p>I put “service locator” in quotes because a normal service locator pattern looks something like this:</p>
<svg class="plantuml" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentstyletype="text/css" height="535.4167px" preserveaspectratio="none" style="width:671px;height:535px;background:#00000000;" version="1.1" viewbox="0 0 671 535" width="671.875px" zoomandpan="magnify"><defs><lineargradient id="g1qtp4070lss2h0" x1="50%" x2="50%" y1="0%" y2="100%"><stop offset="0%" stop-color="#33B2E2"></stop><stop offset="100%" stop-color="#009FDB"></stop></lineargradient><lineargradient id="g1qtp4070lss2h1" x1="50%" x2="50%" y1="0%" y2="100%"><stop offset="0%" stop-color="#3786BE"></stop><stop offset="100%" stop-color="#0568AE"></stop></lineargradient></defs><g><g id="elem_ClassA"><rect codeline="14" fill="url(#g1qtp4070lss2h0)" height="57.0882" id="ClassA" rx="10.4167" ry="10.4167" style="stroke:#33B2E2;stroke-width:1.0416666666666667;" width="87.5" x="183.3333" y="17.7083"></rect><rect fill="url(#g1qtp4070lss2h0)" height="40.4215" rx="10.4167" ry="10.4167" style="stroke:url(#g1qtp4070lss2h0);stroke-width:1.0416666666666667;" width="87.5" x="183.3333" y="17.7083"></rect><rect fill="url(#g1qtp4070lss2h0)" height="10.4167" style="stroke:url(#g1qtp4070lss2h0);stroke-width:1.0416666666666667;" width="87.5" x="183.3333" y="47.7132"></rect><rect codeline="14" fill="none" height="57.0882" id="ClassA" rx="10.4167" ry="10.4167" style="stroke:#33B2E2;stroke-width:1.0416666666666667;" width="87.5" x="183.3333" y="17.7083"></rect><ellipse cx="197.9167" cy="37.9191" fill="none" rx="10.4167" ry="10.4167" style="stroke:#007FAF;stroke-width:1.0416666666666667;"></ellipse><path d="M199.8535,34.5337 C199.1699,34.2082 198.7305,34.1105 198.0794,34.1105 C196.1589,34.1105 194.6777,35.6242 194.6777,37.6261 L194.6777,38.4562 C194.6777,40.3605 196.2402,41.744 198.3561,41.744 C199.2513,41.744 200.1139,41.5161 200.651,41.1092 C201.0905,40.8162 201.3184,40.4907 201.3184,40.1978 C201.3184,39.8722 201.0254,39.5793 200.6999,39.5793 C200.5371,39.5793 200.3906,39.6444 200.2441,39.7746 C199.9023,40.1326 199.9023,40.1326 199.7721,40.1978 C199.4629,40.3931 198.9583,40.4907 198.3887,40.4907 C196.8913,40.4907 195.931,39.6769 195.931,38.4237 L195.931,37.6261 C195.931,36.3078 196.8587,35.3475 198.1283,35.3475 C198.5514,35.3475 199.0072,35.4614 199.349,35.6567 C199.707,35.8521 199.8372,36.0148 199.9023,36.3078 C199.9512,36.617 199.9674,36.6984 200.0651,36.7961 C200.1628,36.91 200.3418,36.9751 200.5046,36.9751 C200.7161,36.9751 200.8952,36.8774 201.0254,36.7147 C201.1068,36.6007 201.1393,36.4705 201.1393,36.145 L201.1393,35.1034 C201.1393,34.7941 201.123,34.6965 201.0417,34.5825 C200.9277,34.3872 200.7324,34.2733 200.5046,34.2733 C200.293,34.2733 200.1465,34.3547 199.9837,34.5825 L199.8535,34.5337 Z " fill="#FFFFFF"></path><text fill="#D2D2D2" font-family='"Verdana"' font-size="11.4583" lengthadjust="spacing" textlength="39.5833" x="219.7917" y="41.8859">ClassA</text><line style="stroke:#33B2E2;stroke-width:1.0416666666666667;" x1="184.375" x2="269.7917" y1="58.1299" y2="58.1299"></line><line style="stroke:#33B2E2;stroke-width:1.0416666666666667;" x1="184.375" x2="269.7917" y1="66.4632" y2="66.4632"></line></g><g id="elem_ServiceLocator"><rect codeline="11" fill="url(#g1qtp4070lss2h0)" height="87.0931" id="ServiceLocator" rx="10.4167" ry="10.4167" style="stroke:#33B2E2;stroke-width:1.0416666666666667;" width="381.25" x="36.4583" y="137.5"></rect><rect fill="url(#g1qtp4070lss2h0)" height="40.4215" rx="10.4167" ry="10.4167" style="stroke:url(#g1qtp4070lss2h0);stroke-width:1.0416666666666667;" width="381.25" x="36.4583" y="137.5"></rect><rect fill="url(#g1qtp4070lss2h0)" height="10.4167" style="stroke:url(#g1qtp4070lss2h0);stroke-width:1.0416666666666667;" width="381.25" x="36.4583" y="167.5049"></rect><rect codeline="11" fill="none" height="87.0931" id="ServiceLocator" rx="10.4167" ry="10.4167" style="stroke:#33B2E2;stroke-width:1.0416666666666667;" width="381.25" x="36.4583" y="137.5"></rect><ellipse cx="170.3125" cy="157.7108" fill="none" rx="10.4167" ry="10.4167" style="stroke:#007FAF;stroke-width:1.0416666666666667;"></ellipse><path d="M172.2493,154.3254 C171.5658,153.9998 171.1263,153.9022 170.4753,153.9022 C168.5547,153.9022 167.0736,155.4159 167.0736,157.4178 L167.0736,158.2479 C167.0736,160.1522 168.6361,161.5356 170.752,161.5356 C171.6471,161.5356 172.5098,161.3078 173.0469,160.9009 C173.4863,160.6079 173.7142,160.2824 173.7142,159.9894 C173.7142,159.6639 173.4212,159.3709 173.0957,159.3709 C172.9329,159.3709 172.7865,159.436 172.64,159.5662 C172.2982,159.9243 172.2982,159.9243 172.168,159.9894 C171.8587,160.1847 171.3542,160.2824 170.7845,160.2824 C169.2871,160.2824 168.3268,159.4686 168.3268,158.2153 L168.3268,157.4178 C168.3268,156.0994 169.2546,155.1392 170.5241,155.1392 C170.9473,155.1392 171.403,155.2531 171.7448,155.4484 C172.1029,155.6437 172.2331,155.8065 172.2982,156.0994 C172.347,156.4087 172.3633,156.4901 172.4609,156.5877 C172.5586,156.7017 172.7376,156.7668 172.9004,156.7668 C173.112,156.7668 173.291,156.6691 173.4212,156.5063 C173.5026,156.3924 173.5352,156.2622 173.5352,155.9367 L173.5352,154.895 C173.5352,154.5858 173.5189,154.4881 173.4375,154.3742 C173.3236,154.1789 173.1283,154.0649 172.9004,154.0649 C172.6888,154.0649 172.5423,154.1463 172.3796,154.3742 L172.2493,154.3254 Z " fill="#FFFFFF"></path><text fill="#D2D2D2" font-family='"Verdana"' font-size="11.4583" lengthadjust="spacing" textlength="88.5417" x="198.4375" y="161.6776">ServiceLocator</text><line style="stroke:#33B2E2;stroke-width:1.0416666666666667;" x1="37.5" x2="416.6667" y1="177.9215" y2="177.9215"></line><line style="stroke:#33B2E2;stroke-width:1.0416666666666667;" x1="37.5" x2="416.6667" y1="186.2549" y2="186.2549"></line><text fill="#D2D2D2" font-family='"Verdana"' font-size="11.4583" lengthadjust="spacing" textlength="352.0833" x="51.0417" y="209.3908">locate(ServiceKey&lt;T&gt;) : Service&lt;T extends Service&lt;T&gt;&gt;</text></g><g id="elem_Service"><rect codeline="7" fill="url(#g1qtp4070lss2h0)" height="117.098" id="Service" rx="10.4167" ry="10.4167" style="stroke:#33B2E2;stroke-width:1.0416666666666667;" width="254.1667" x="100" y="287.5"></rect><rect fill="url(#g1qtp4070lss2h0)" height="40.4215" rx="10.4167" ry="10.4167" style="stroke:url(#g1qtp4070lss2h0);stroke-width:1.0416666666666667;" width="254.1667" x="100" y="287.5"></rect><rect fill="url(#g1qtp4070lss2h0)" height="10.4167" style="stroke:url(#g1qtp4070lss2h0);stroke-width:1.0416666666666667;" width="254.1667" x="100" y="317.5049"></rect><rect codeline="7" fill="none" height="117.098" id="Service" rx="10.4167" ry="10.4167" style="stroke:#33B2E2;stroke-width:1.0416666666666667;" width="254.1667" x="100" y="287.5"></rect><ellipse cx="114.5833" cy="307.7108" fill="none" rx="10.4167" ry="10.4167" style="stroke:#007FAF;stroke-width:1.0416666666666667;"></ellipse><path d="M116.5202,304.3254 C115.8366,303.9998 115.3971,303.9022 114.7461,303.9022 C112.8255,303.9022 111.3444,305.4159 111.3444,307.4178 L111.3444,308.2479 C111.3444,310.1522 112.9069,311.5356 115.0228,311.5356 C115.918,311.5356 116.7806,311.3078 117.3177,310.9009 C117.7572,310.6079 117.985,310.2824 117.985,309.9894 C117.985,309.6639 117.6921,309.3709 117.3665,309.3709 C117.2038,309.3709 117.0573,309.436 116.9108,309.5662 C116.569,309.9243 116.569,309.9243 116.4388,309.9894 C116.1296,310.1847 115.625,310.2824 115.0553,310.2824 C113.5579,310.2824 112.5977,309.4686 112.5977,308.2153 L112.5977,307.4178 C112.5977,306.0994 113.5254,305.1392 114.7949,305.1392 C115.2181,305.1392 115.6738,305.2531 116.0156,305.4484 C116.3737,305.6437 116.5039,305.8065 116.569,306.0994 C116.6178,306.4087 116.6341,306.4901 116.7318,306.5877 C116.8294,306.7017 117.0085,306.7668 117.1712,306.7668 C117.3828,306.7668 117.5618,306.6691 117.6921,306.5063 C117.7734,306.3924 117.806,306.2622 117.806,305.9367 L117.806,304.895 C117.806,304.5858 117.7897,304.4881 117.7083,304.3742 C117.5944,304.1789 117.3991,304.0649 117.1712,304.0649 C116.9596,304.0649 116.8132,304.1463 116.6504,304.3742 L116.5202,304.3254 Z " fill="#FFFFFF"></path><text fill="#D2D2D2" font-family='"Verdana"' font-size="11.4583" lengthadjust="spacing" textlength="45.8333" x="136.4583" y="311.6776">Service</text><rect fill="none" height="33.3008" style="stroke:#33B2E2;stroke-width:1.0416666666666667;stroke-dasharray:2.0,2.0;" width="158.3333" x="198.9583" y="284.375"></rect><text fill="#5A5A5A" font-family="Verdana" font-size="12.5" font-style="italic" lengthadjust="spacing" textlength="139.5833" x="208.3333" y="305.3528">T extends Service&lt;T&gt;</text><line style="stroke:#33B2E2;stroke-width:1.0416666666666667;" x1="101.0417" x2="353.125" y1="327.9215" y2="327.9215"></line><line style="stroke:#33B2E2;stroke-width:1.0416666666666667;" x1="101.0417" x2="353.125" y1="336.2549" y2="336.2549"></line><text fill="#D2D2D2" font-family='"Verdana"' font-size="11.4583" lengthadjust="spacing" textlength="58.3333" x="114.5833" y="359.3908">initialize()</text><text fill="#D2D2D2" font-family='"Verdana"' font-size="11.4583" lengthadjust="spacing" textlength="169.7917" x="114.5833" y="389.3957">serviceState(): ServiceState</text></g><g id="elem_Service01"><rect codeline="15" fill="url(#g1qtp4070lss2h0)" height="57.0882" id="Service01" rx="10.4167" ry="10.4167" style="stroke:#33B2E2;stroke-width:1.0416666666666667;" width="191.6667" x="17.7083" y="466.6667"></rect><rect fill="url(#g1qtp4070lss2h0)" height="40.4215" rx="10.4167" ry="10.4167" style="stroke:url(#g1qtp4070lss2h0);stroke-width:1.0416666666666667;" width="191.6667" x="17.7083" y="466.6667"></rect><rect fill="url(#g1qtp4070lss2h0)" height="10.4167" style="stroke:url(#g1qtp4070lss2h0);stroke-width:1.0416666666666667;" width="191.6667" x="17.7083" y="496.6715"></rect><rect codeline="15" fill="none" height="57.0882" id="Service01" rx="10.4167" ry="10.4167" style="stroke:#33B2E2;stroke-width:1.0416666666666667;" width="191.6667" x="17.7083" y="466.6667"></rect><ellipse cx="32.2917" cy="486.8774" fill="none" rx="10.4167" ry="10.4167" style="stroke:#007FAF;stroke-width:1.0416666666666667;"></ellipse><path d="M34.2285,483.492 C33.5449,483.1665 33.1055,483.0688 32.4544,483.0688 C30.5339,483.0688 29.0527,484.5825 29.0527,486.5845 L29.0527,487.4146 C29.0527,489.3188 30.6152,490.7023 32.7311,490.7023 C33.6263,490.7023 34.4889,490.4744 35.026,490.0675 C35.4655,489.7746 35.6934,489.4491 35.6934,489.1561 C35.6934,488.8306 35.4004,488.5376 35.0749,488.5376 C34.9121,488.5376 34.7656,488.6027 34.6191,488.7329 C34.2773,489.091 34.2773,489.091 34.1471,489.1561 C33.8379,489.3514 33.3333,489.4491 32.7637,489.4491 C31.2663,489.4491 30.306,488.6353 30.306,487.382 L30.306,486.5845 C30.306,485.2661 31.2337,484.3058 32.5033,484.3058 C32.9264,484.3058 33.3822,484.4198 33.724,484.6151 C34.082,484.8104 34.2122,484.9731 34.2773,485.2661 C34.3262,485.5754 34.3424,485.6567 34.4401,485.7544 C34.5378,485.8683 34.7168,485.9334 34.8796,485.9334 C35.0911,485.9334 35.2702,485.8358 35.4004,485.673 C35.4818,485.5591 35.5143,485.4289 35.5143,485.1034 L35.5143,484.0617 C35.5143,483.7524 35.498,483.6548 35.4167,483.5409 C35.3027,483.3455 35.1074,483.2316 34.8796,483.2316 C34.668,483.2316 34.5215,483.313 34.3587,483.5409 L34.2285,483.492 Z " fill="#FFFFFF"></path><text fill="#D2D2D2" font-family='"Verdana"' font-size="11.4583" lengthadjust="spacing" textlength="60.4167" x="54.1667" y="490.8442">Service01</text><rect fill="none" height="33.3008" style="stroke:#33B2E2;stroke-width:1.0416666666666667;stroke-dasharray:2.0,2.0;" width="81.25" x="131.25" y="463.5417"></rect><text fill="#5A5A5A" font-family="Verdana" font-size="12.5" font-style="italic" lengthadjust="spacing" textlength="62.5" x="140.625" y="484.5194">Service01</text><line style="stroke:#33B2E2;stroke-width:1.0416666666666667;" x1="18.75" x2="208.3333" y1="507.0882" y2="507.0882"></line><line style="stroke:#33B2E2;stroke-width:1.0416666666666667;" x1="18.75" x2="208.3333" y1="515.4215" y2="515.4215"></line></g><g id="elem_Service02"><rect codeline="16" fill="url(#g1qtp4070lss2h0)" height="57.0882" id="Service02" rx="10.4167" ry="10.4167" style="stroke:#33B2E2;stroke-width:1.0416666666666667;" width="191.6667" x="245.8333" y="466.6667"></rect><rect fill="url(#g1qtp4070lss2h0)" height="40.4215" rx="10.4167" ry="10.4167" style="stroke:url(#g1qtp4070lss2h0);stroke-width:1.0416666666666667;" width="191.6667" x="245.8333" y="466.6667"></rect><rect fill="url(#g1qtp4070lss2h0)" height="10.4167" style="stroke:url(#g1qtp4070lss2h0);stroke-width:1.0416666666666667;" width="191.6667" x="245.8333" y="496.6715"></rect><rect codeline="16" fill="none" height="57.0882" id="Service02" rx="10.4167" ry="10.4167" style="stroke:#33B2E2;stroke-width:1.0416666666666667;" width="191.6667" x="245.8333" y="466.6667"></rect><ellipse cx="260.4167" cy="486.8774" fill="none" rx="10.4167" ry="10.4167" style="stroke:#007FAF;stroke-width:1.0416666666666667;"></ellipse><path d="M262.3535,483.492 C261.6699,483.1665 261.2305,483.0688 260.5794,483.0688 C258.6589,483.0688 257.1777,484.5825 257.1777,486.5845 L257.1777,487.4146 C257.1777,489.3188 258.7402,490.7023 260.8561,490.7023 C261.7513,490.7023 262.6139,490.4744 263.151,490.0675 C263.5905,489.7746 263.8184,489.4491 263.8184,489.1561 C263.8184,488.8306 263.5254,488.5376 263.1999,488.5376 C263.0371,488.5376 262.8906,488.6027 262.7441,488.7329 C262.4023,489.091 262.4023,489.091 262.2721,489.1561 C261.9629,489.3514 261.4583,489.4491 260.8887,489.4491 C259.3913,489.4491 258.431,488.6353 258.431,487.382 L258.431,486.5845 C258.431,485.2661 259.3587,484.3058 260.6283,484.3058 C261.0514,484.3058 261.5072,484.4198 261.849,484.6151 C262.207,484.8104 262.3372,484.9731 262.4023,485.2661 C262.4512,485.5754 262.4674,485.6567 262.5651,485.7544 C262.6628,485.8683 262.8418,485.9334 263.0046,485.9334 C263.2161,485.9334 263.3952,485.8358 263.5254,485.673 C263.6068,485.5591 263.6393,485.4289 263.6393,485.1034 L263.6393,484.0617 C263.6393,483.7524 263.623,483.6548 263.5417,483.5409 C263.4277,483.3455 263.2324,483.2316 263.0046,483.2316 C262.793,483.2316 262.6465,483.313 262.4837,483.5409 L262.3535,483.492 Z " fill="#FFFFFF"></path><text fill="#D2D2D2" font-family='"Verdana"' font-size="11.4583" lengthadjust="spacing" textlength="60.4167" x="282.2917" y="490.8442">Service02</text><rect fill="none" height="33.3008" style="stroke:#33B2E2;stroke-width:1.0416666666666667;stroke-dasharray:2.0,2.0;" width="81.25" x="359.375" y="463.5417"></rect><text fill="#5A5A5A" font-family="Verdana" font-size="12.5" font-style="italic" lengthadjust="spacing" textlength="62.5" x="368.75" y="484.5194">Service02</text><line style="stroke:#33B2E2;stroke-width:1.0416666666666667;" x1="246.875" x2="436.4583" y1="507.0882" y2="507.0882"></line><line style="stroke:#33B2E2;stroke-width:1.0416666666666667;" x1="246.875" x2="436.4583" y1="515.4215" y2="515.4215"></line></g><g id="elem_GMN619437"><path d="M307.2917,35.9375 L307.2917,42.1875 L271.126,46.3542 L307.2917,50.5208 L307.2917,56.7383 A10.4167,10.4167 0 0 0 317.7083,67.1549 L648.9583,67.1549 A10.4167,10.4167 0 0 0 659.375,56.7383 L659.375,35.9375 L648.9583,25.5208 L317.7083,25.5208 A10.4167,10.4167 0 0 0 307.2917,35.9375 " fill="url(#g1qtp4070lss2h1)" style="stroke:#007FAF;stroke-width:1.0416666666666667;"></path><path d="M648.9583,25.5208 L648.9583,30.7292 A5.2083,5.2083 0 0 0 654.1667,35.9375 L659.375,35.9375 L648.9583,25.5208 " fill="url(#g1qtp4070lss2h1)" style="stroke:#007FAF;stroke-width:1.0416666666666667;"></path><text fill="#FFFFFF" font-family='"Verdana"' font-size="12.5" lengthadjust="spacing" textlength="313.5417" x="321.875" y="50.6653">May be a service or just an unencapsulated class.</text></g><g id="link_ClassA_ServiceLocator"><path codeline="3" d="M227.0833,89.1635 C227.0833,104.474 227.0833,121.8198 227.0833,137.2344 " fill="none" id="ClassA-backto-ServiceLocator" style="stroke:#009FDB;stroke-width:3.125;"></path><polygon fill="none" points="227.0833,75.2375,222.9167,81.4875,227.0833,87.7375,231.25,81.4875,227.0833,75.2375" style="stroke:#009FDB;stroke-width:3.125;"></polygon></g><g id="link_ServiceLocator_Service"><path codeline="5" d="M227.0833,237.9125 C227.0833,237.9125 227.0833,274.8844 227.0833,274.8844 " fill="none" id="ServiceLocator-Service" style="stroke:#009FDB;stroke-width:3.125;"></path><polygon fill="none" points="227.0833,287.3844,231.25,281.1344,227.0833,274.8844,222.9167,281.1344,227.0833,287.3844" style="stroke:#009FDB;stroke-width:3.125;"></polygon><polygon fill="#009FDB" points="227.0833,225.4125,222.9167,231.6625,227.0833,237.9125,231.25,231.6625,227.0833,225.4125" style="stroke:#009FDB;stroke-width:3.125;"></polygon><text fill="#5A5A5A" font-family='"Verdana"' font-size="12.5" lengthadjust="spacing" textlength="7.2917" x="209.9235" y="253.0329">1</text><text fill="#5A5A5A" font-family='"Verdana"' font-size="12.5" lengthadjust="spacing" textlength="7.2917" x="209.9235" y="267.7252">*</text></g><g id="link_Service_Service01"><path d="M169.9521,421.0405 C157.4771,437.2352 145.025,453.3997 135.0063,466.406 " fill="none" id="Service-backto-Service01" style="stroke:#009FDB;stroke-width:3.125;stroke-dasharray:7.0,7.0;"></path><polygon fill="none" points="164.3698,416.3385,182.8604,404.2844,175.9229,425.2382,164.3698,416.3385" style="stroke:#009FDB;stroke-width:3.125;"></polygon></g><g id="link_Service_Service02"><path d="M284.7385,421.0405 C297.3281,437.2352 309.8938,453.3997 320.0052,466.406 " fill="none" id="Service-backto-Service02" style="stroke:#009FDB;stroke-width:3.125;stroke-dasharray:7.0,7.0;"></path><polygon fill="none" points="278.7417,425.2074,271.7125,404.2844,290.2552,416.2573,278.7417,425.2074" style="stroke:#009FDB;stroke-width:3.125;"></polygon></g></g></svg><p>Then in order to <em>locate</em> a service, you just pass the service key to the locator:</p>
<svg class="mermaid" aria-labelledby="chart-title-mermaid-svg chart-desc-mermaid-svg" role="img" viewbox="-50 -10 710 576" style="max-width: 710px;" height="576" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid-svg"><title id="chart-title-mermaid-svg"></title>
<desc id="chart-desc-mermaid-svg"></desc><style>#mermaid-svg {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#ccc;}#mermaid-svg .error-icon{fill:#a44141;}#mermaid-svg .error-text{fill:#ddd;stroke:#ddd;}#mermaid-svg .edge-thickness-normal{stroke-width:2px;}#mermaid-svg .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg .marker{fill:lightgrey;stroke:lightgrey;}#mermaid-svg .marker.cross{stroke:lightgrey;}#mermaid-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg .actor{stroke:#81B1DB;fill:#1f2020;}#mermaid-svg text.actor&gt;tspan{fill:lightgrey;stroke:none;}#mermaid-svg .actor-line{stroke:lightgrey;}#mermaid-svg .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:lightgrey;}#mermaid-svg .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:lightgrey;}#mermaid-svg #arrowhead path{fill:lightgrey;stroke:lightgrey;}#mermaid-svg .sequenceNumber{fill:black;}#mermaid-svg #sequencenumber{fill:lightgrey;}#mermaid-svg #crosshead path{fill:lightgrey;stroke:lightgrey;}#mermaid-svg .messageText{fill:lightgrey;stroke:lightgrey;}#mermaid-svg .labelBox{stroke:#81B1DB;fill:#1f2020;}#mermaid-svg .labelText,#mermaid-svg .labelText&gt;tspan{fill:lightgrey;stroke:none;}#mermaid-svg .loopText,#mermaid-svg .loopText&gt;tspan{fill:lightgrey;stroke:none;}#mermaid-svg .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:#81B1DB;fill:#81B1DB;}#mermaid-svg .note{stroke:hsl(180, 0%, 18.3529411765%);fill:#1b1b1e;}#mermaid-svg .noteText,#mermaid-svg .noteText&gt;tspan{fill:#6b747c;stroke:none;}#mermaid-svg .activation0{fill:hsl(180, 1.5873015873%, 28.3529411765%);stroke:#81B1DB;}#mermaid-svg .activation1{fill:hsl(180, 1.5873015873%, 28.3529411765%);stroke:#81B1DB;}#mermaid-svg .activation2{fill:hsl(180, 1.5873015873%, 28.3529411765%);stroke:#81B1DB;}#mermaid-svg .actorPopupMenu{position:absolute;}#mermaid-svg .actorPopupMenuPanel{position:absolute;fill:#1f2020;box-shadow:0px 8px 16px 0px rgba(0,0,0,0.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / 0.4));}#mermaid-svg .actor-man line{stroke:#81B1DB;fill:#1f2020;}#mermaid-svg .actor-man circle,#mermaid-svg line{stroke:#81B1DB;fill:#1f2020;stroke-width:2px;}#mermaid-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style>
<g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><g><line stroke="#999" stroke-width="0.5px" class="200" y2="510" x2="75" y1="5" x1="75" id="actor0"></line><g id="root-0"><rect class="actor" ry="3" rx="3" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor: middle; font-size: 14px; font-weight: 400;" class="actor" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">ClassA</tspan></text></g></g><g><line stroke="#999" stroke-width="0.5px" class="200" y2="510" x2="335" y1="5" x1="335" id="actor1"></line><g id="root-1"><rect class="actor" ry="3" rx="3" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="260"></rect><text style="text-anchor: middle; font-size: 14px; font-weight: 400;" class="actor" alignment-baseline="central" dominant-baseline="central" y="32.5" x="335"><tspan dy="0" x="335">Service Locator</tspan></text></g></g><g><line stroke="#999" stroke-width="0.5px" class="200" y2="510" x2="535" y1="5" x1="535" id="actor2"></line><g id="root-2"><rect class="actor" ry="3" rx="3" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="460"></rect><text style="text-anchor: middle; font-size: 14px; font-weight: 400;" class="actor" alignment-baseline="central" dominant-baseline="central" y="32.5" x="535"><tspan dy="0" x="535">Service</tspan></text></g></g><defs><marker orient="auto" markerheight="12" markerwidth="12" markerunits="userSpaceOnUse" refy="5" refx="9" id="arrowhead"><path d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refy="4" refx="16" orient="auto" markerheight="8" markerwidth="15" id="crosshead"><path style="stroke-dasharray: 0, 0;" d="M 9,2 V 6 L16,4 Z" stroke-width="1px" stroke="#000000" fill="black"></path><path style="stroke-dasharray: 0, 0;" d="M 0,1 L 6,7 M 6,1 L 0,7" stroke-width="1px" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerheight="28" markerwidth="20" refy="7" refx="18" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerheight="40" markerwidth="60" refy="15" refx="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><g><rect class="activation0" ry="0" rx="0" height="359" width="10" stroke="#666" fill="#EDF2AE" y="111" x="330"></rect></g><g><rect class="activation0" ry="0" rx="0" height="44" width="10" stroke="#666" fill="#EDF2AE" y="280" x="530"></rect></g><g><rect class="activation0" ry="0" rx="0" height="44" width="10" stroke="#666" fill="#EDF2AE" y="372" x="530"></rect></g><g><line class="loopLine" y2="197" x2="550" y1="197" x1="320"></line><line class="loopLine" y2="426" x2="550" y1="197" x1="550"></line><line class="loopLine" y2="426" x2="550" y1="426" x1="320"></line><line class="loopLine" y2="426" x2="320" y1="197" x1="320"></line><polygon class="labelBox" points="320,197 370,197 370,210 361.6,217 320,217"></polygon><text style="font-size: 16px; font-weight: 400;" class="labelText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="210" x="345">alt</text><text style="font-size: 16px; font-weight: 400;" class="loopText" text-anchor="middle" y="215" x="460"><tspan x="460">[Not Ready]</tspan></text></g><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="205">locate(ServiceKey&lt;Service&gt;)</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="111" x2="335" y1="111" x1="75"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="126" x="340">checkIfReady</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 340,157 C 400,147 400,187 340,177"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="247" x="438">create()</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="278" x2="535" y1="278" x1="340"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="293" x="435">new(Service)</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="324" x2="340" y1="324" x1="530"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="339" x="438">initialize()</text><line style="fill: none;" marker-end="url(#filled-head)" stroke="none" stroke-width="2" class="messageLine0" y2="370" x2="535" y1="370" x1="340"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="385" x="435">ready()</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#filled-head)" stroke="none" stroke-width="2" class="messageLine1" y2="416" x2="340" y1="416" x1="530"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="441" x="203">Service</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="470" x2="75" y1="470" x1="330"></line><g><rect class="actor" ry="3" rx="3" height="65" width="150" stroke="#666" fill="#eaeaea" y="490" x="0"></rect><text style="text-anchor: middle; font-size: 14px; font-weight: 400;" class="actor" alignment-baseline="central" dominant-baseline="central" y="522.5" x="75"><tspan dy="0" x="75">ClassA</tspan></text></g><g><rect class="actor" ry="3" rx="3" height="65" width="150" stroke="#666" fill="#eaeaea" y="490" x="260"></rect><text style="text-anchor: middle; font-size: 14px; font-weight: 400;" class="actor" alignment-baseline="central" dominant-baseline="central" y="522.5" x="335"><tspan dy="0" x="335">Service Locator</tspan></text></g><g><rect class="actor" ry="3" rx="3" height="65" width="150" stroke="#666" fill="#eaeaea" y="490" x="460"></rect><text style="text-anchor: middle; font-size: 14px; font-weight: 400;" class="actor" alignment-baseline="central" dominant-baseline="central" y="522.5" x="535"><tspan dy="0" x="535">Service</tspan></text></g><style>@import url("https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css");</style></svg><p>When services depend on each other you try to keep it out of the initialize step, or at a minimum keep it as a directed acyclic graph inside the initialize step so that they won’t deadlock.</p>
<p>This is almost, but not quite, entirely unlike what this system did.</p>
<h2 id="the-systems-design">
<span class="mr-2">The System’s Design</span><a href="#the-systems-design" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h2>
<p>While the system was clearly inspired by a service locator pattern, in an effort to make it “type safe” it had made certain allowances in its design:</p>
<svg class="plantuml" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentstyletype="text/css" height="295.8333px" preserveaspectratio="none" style="width:365px;height:295px;background:#00000000;" version="1.1" viewbox="0 0 365 295" width="365.625px" zoomandpan="magnify"><defs><lineargradient id="gc3dlo1wsz8kq0" x1="50%" x2="50%" y1="0%" y2="100%"><stop offset="0%" stop-color="#33B2E2"></stop><stop offset="100%" stop-color="#009FDB"></stop></lineargradient></defs><g><g id="elem_ClassA"><rect codeline="3" fill="url(#gc3dlo1wsz8kq0)" height="57.0882" id="ClassA" rx="10.4167" ry="10.4167" style="stroke:#33B2E2;stroke-width:1.0416666666666667;" width="87.5" x="17.7083" y="227.0833"></rect><rect fill="url(#gc3dlo1wsz8kq0)" height="40.4215" rx="10.4167" ry="10.4167" style="stroke:url(#gc3dlo1wsz8kq0);stroke-width:1.0416666666666667;" width="87.5" x="17.7083" y="227.0833"></rect><rect fill="url(#gc3dlo1wsz8kq0)" height="10.4167" style="stroke:url(#gc3dlo1wsz8kq0);stroke-width:1.0416666666666667;" width="87.5" x="17.7083" y="257.0882"></rect><rect codeline="3" fill="none" height="57.0882" id="ClassA" rx="10.4167" ry="10.4167" style="stroke:#33B2E2;stroke-width:1.0416666666666667;" width="87.5" x="17.7083" y="227.0833"></rect><ellipse cx="32.2917" cy="247.2941" fill="none" rx="10.4167" ry="10.4167" style="stroke:#007FAF;stroke-width:1.0416666666666667;"></ellipse><path d="M34.2285,243.9087 C33.5449,243.5832 33.1055,243.4855 32.4544,243.4855 C30.5339,243.4855 29.0527,244.9992 29.0527,247.0011 L29.0527,247.8312 C29.0527,249.7355 30.6152,251.119 32.7311,251.119 C33.6263,251.119 34.4889,250.8911 35.026,250.4842 C35.4655,250.1912 35.6934,249.8657 35.6934,249.5728 C35.6934,249.2472 35.4004,248.9543 35.0749,248.9543 C34.9121,248.9543 34.7656,249.0194 34.6191,249.1496 C34.2773,249.5076 34.2773,249.5076 34.1471,249.5728 C33.8379,249.7681 33.3333,249.8657 32.7637,249.8657 C31.2663,249.8657 30.306,249.0519 30.306,247.7987 L30.306,247.0011 C30.306,245.6828 31.2337,244.7225 32.5033,244.7225 C32.9264,244.7225 33.3822,244.8364 33.724,245.0317 C34.082,245.2271 34.2122,245.3898 34.2773,245.6828 C34.3262,245.992 34.3424,246.0734 34.4401,246.1711 C34.5378,246.285 34.7168,246.3501 34.8796,246.3501 C35.0911,246.3501 35.2702,246.2524 35.4004,246.0897 C35.4818,245.9757 35.5143,245.8455 35.5143,245.52 L35.5143,244.4784 C35.5143,244.1691 35.498,244.0715 35.4167,243.9575 C35.3027,243.7622 35.1074,243.6483 34.8796,243.6483 C34.668,243.6483 34.5215,243.7297 34.3587,243.9575 L34.2285,243.9087 Z " fill="#FFFFFF"></path><text fill="#D2D2D2" font-family='"Verdana"' font-size="11.4583" lengthadjust="spacing" textlength="39.5833" x="54.1667" y="251.2609">ClassA</text><line style="stroke:#33B2E2;stroke-width:1.0416666666666667;" x1="18.75" x2="104.1667" y1="267.5049" y2="267.5049"></line><line style="stroke:#33B2E2;stroke-width:1.0416666666666667;" x1="18.75" x2="104.1667" y1="275.8382" y2="275.8382"></line></g><g id="elem_ClassB"><rect codeline="4" fill="url(#gc3dlo1wsz8kq0)" height="57.0882" id="ClassB" rx="10.4167" ry="10.4167" style="stroke:#33B2E2;stroke-width:1.0416666666666667;" width="87.5" x="141.6667" y="227.0833"></rect><rect fill="url(#gc3dlo1wsz8kq0)" height="40.4215" rx="10.4167" ry="10.4167" style="stroke:url(#gc3dlo1wsz8kq0);stroke-width:1.0416666666666667;" width="87.5" x="141.6667" y="227.0833"></rect><rect fill="url(#gc3dlo1wsz8kq0)" height="10.4167" style="stroke:url(#gc3dlo1wsz8kq0);stroke-width:1.0416666666666667;" width="87.5" x="141.6667" y="257.0882"></rect><rect codeline="4" fill="none" height="57.0882" id="ClassB" rx="10.4167" ry="10.4167" style="stroke:#33B2E2;stroke-width:1.0416666666666667;" width="87.5" x="141.6667" y="227.0833"></rect><ellipse cx="156.25" cy="247.2941" fill="none" rx="10.4167" ry="10.4167" style="stroke:#007FAF;stroke-width:1.0416666666666667;"></ellipse><path d="M158.1868,243.9087 C157.5033,243.5832 157.0638,243.4855 156.4128,243.4855 C154.4922,243.4855 153.0111,244.9992 153.0111,247.0011 L153.0111,247.8312 C153.0111,249.7355 154.5736,251.119 156.6895,251.119 C157.5846,251.119 158.4473,250.8911 158.9844,250.4842 C159.4238,250.1912 159.6517,249.8657 159.6517,249.5728 C159.6517,249.2472 159.3587,248.9543 159.0332,248.9543 C158.8704,248.9543 158.724,249.0194 158.5775,249.1496 C158.2357,249.5076 158.2357,249.5076 158.1055,249.5728 C157.7962,249.7681 157.2917,249.8657 156.722,249.8657 C155.2246,249.8657 154.2643,249.0519 154.2643,247.7987 L154.2643,247.0011 C154.2643,245.6828 155.1921,244.7225 156.4616,244.7225 C156.8848,244.7225 157.3405,244.8364 157.6823,245.0317 C158.0404,245.2271 158.1706,245.3898 158.2357,245.6828 C158.2845,245.992 158.3008,246.0734 158.3984,246.1711 C158.4961,246.285 158.6751,246.3501 158.8379,246.3501 C159.0495,246.3501 159.2285,246.2524 159.3587,246.0897 C159.4401,245.9757 159.4727,245.8455 159.4727,245.52 L159.4727,244.4784 C159.4727,244.1691 159.4564,244.0715 159.375,243.9575 C159.2611,243.7622 159.0658,243.6483 158.8379,243.6483 C158.6263,243.6483 158.4798,243.7297 158.3171,243.9575 L158.1868,243.9087 Z " fill="#FFFFFF"></path><text fill="#D2D2D2" font-family='"Verdana"' font-size="11.4583" lengthadjust="spacing" textlength="39.5833" x="178.125" y="251.2609">ClassB</text><line style="stroke:#33B2E2;stroke-width:1.0416666666666667;" x1="142.7083" x2="228.125" y1="267.5049" y2="267.5049"></line><line style="stroke:#33B2E2;stroke-width:1.0416666666666667;" x1="142.7083" x2="228.125" y1="275.8382" y2="275.8382"></line></g><g id="elem_ClassC"><rect codeline="5" fill="url(#gc3dlo1wsz8kq0)" height="57.0882" id="ClassC" rx="10.4167" ry="10.4167" style="stroke:#33B2E2;stroke-width:1.0416666666666667;" width="87.5" x="265.625" y="227.0833"></rect><rect fill="url(#gc3dlo1wsz8kq0)" height="40.4215" rx="10.4167" ry="10.4167" style="stroke:url(#gc3dlo1wsz8kq0);stroke-width:1.0416666666666667;" width="87.5" x="265.625" y="227.0833"></rect><rect fill="url(#gc3dlo1wsz8kq0)" height="10.4167" style="stroke:url(#gc3dlo1wsz8kq0);stroke-width:1.0416666666666667;" width="87.5" x="265.625" y="257.0882"></rect><rect codeline="5" fill="none" height="57.0882" id="ClassC" rx="10.4167" ry="10.4167" style="stroke:#33B2E2;stroke-width:1.0416666666666667;" width="87.5" x="265.625" y="227.0833"></rect><ellipse cx="280.2083" cy="247.2941" fill="none" rx="10.4167" ry="10.4167" style="stroke:#007FAF;stroke-width:1.0416666666666667;"></ellipse><path d="M282.1452,243.9087 C281.4616,243.5832 281.0221,243.4855 280.3711,243.4855 C278.4505,243.4855 276.9694,244.9992 276.9694,247.0011 L276.9694,247.8312 C276.9694,249.7355 278.5319,251.119 280.6478,251.119 C281.543,251.119 282.4056,250.8911 282.9427,250.4842 C283.3822,250.1912 283.61,249.8657 283.61,249.5728 C283.61,249.2472 283.3171,248.9543 282.9915,248.9543 C282.8288,248.9543 282.6823,249.0194 282.5358,249.1496 C282.194,249.5076 282.194,249.5076 282.0638,249.5728 C281.7546,249.7681 281.25,249.8657 280.6803,249.8657 C279.1829,249.8657 278.2227,249.0519 278.2227,247.7987 L278.2227,247.0011 C278.2227,245.6828 279.1504,244.7225 280.4199,244.7225 C280.8431,244.7225 281.2988,244.8364 281.6406,245.0317 C281.9987,245.2271 282.1289,245.3898 282.194,245.6828 C282.2428,245.992 282.2591,246.0734 282.3568,246.1711 C282.4544,246.285 282.6335,246.3501 282.7962,246.3501 C283.0078,246.3501 283.1868,246.2524 283.3171,246.0897 C283.3984,245.9757 283.431,245.8455 283.431,245.52 L283.431,244.4784 C283.431,244.1691 283.4147,244.0715 283.3333,243.9575 C283.2194,243.7622 283.0241,243.6483 282.7962,243.6483 C282.5846,243.6483 282.4382,243.7297 282.2754,243.9575 L282.1452,243.9087 Z " fill="#FFFFFF"></path><text fill="#D2D2D2" font-family='"Verdana"' font-size="11.4583" lengthadjust="spacing" textlength="39.5833" x="302.0833" y="251.2609">ClassC</text><line style="stroke:#33B2E2;stroke-width:1.0416666666666667;" x1="266.6667" x2="352.0833" y1="267.5049" y2="267.5049"></line><line style="stroke:#33B2E2;stroke-width:1.0416666666666667;" x1="266.6667" x2="352.0833" y1="275.8382" y2="275.8382"></line></g><g id="elem_Root"><rect codeline="7" fill="url(#gc3dlo1wsz8kq0)" height="147.1029" id="Root" rx="10.4167" ry="10.4167" style="stroke:#33B2E2;stroke-width:1.0416666666666667;" width="160.4167" x="105.2083" y="17.7083"></rect><rect fill="url(#gc3dlo1wsz8kq0)" height="40.4215" rx="10.4167" ry="10.4167" style="stroke:url(#gc3dlo1wsz8kq0);stroke-width:1.0416666666666667;" width="160.4167" x="105.2083" y="17.7083"></rect><rect fill="url(#gc3dlo1wsz8kq0)" height="10.4167" style="stroke:url(#gc3dlo1wsz8kq0);stroke-width:1.0416666666666667;" width="160.4167" x="105.2083" y="47.7132"></rect><rect codeline="7" fill="none" height="147.1029" id="Root" rx="10.4167" ry="10.4167" style="stroke:#33B2E2;stroke-width:1.0416666666666667;" width="160.4167" x="105.2083" y="17.7083"></rect><ellipse cx="159.8958" cy="37.9191" fill="none" rx="10.4167" ry="10.4167" style="stroke:#007FAF;stroke-width:1.0416666666666667;"></ellipse><path d="M161.8327,34.5337 C161.1491,34.2082 160.7096,34.1105 160.0586,34.1105 C158.138,34.1105 156.6569,35.6242 156.6569,37.6261 L156.6569,38.4562 C156.6569,40.3605 158.2194,41.744 160.3353,41.744 C161.2305,41.744 162.0931,41.5161 162.6302,41.1092 C163.0697,40.8162 163.2975,40.4907 163.2975,40.1978 C163.2975,39.8722 163.0046,39.5793 162.679,39.5793 C162.5163,39.5793 162.3698,39.6444 162.2233,39.7746 C161.8815,40.1326 161.8815,40.1326 161.7513,40.1978 C161.4421,40.3931 160.9375,40.4907 160.3678,40.4907 C158.8704,40.4907 157.9102,39.6769 157.9102,38.4237 L157.9102,37.6261 C157.9102,36.3078 158.8379,35.3475 160.1074,35.3475 C160.5306,35.3475 160.9863,35.4614 161.3281,35.6567 C161.6862,35.8521 161.8164,36.0148 161.8815,36.3078 C161.9303,36.617 161.9466,36.6984 162.0443,36.7961 C162.1419,36.91 162.321,36.9751 162.4837,36.9751 C162.6953,36.9751 162.8743,36.8774 163.0046,36.7147 C163.0859,36.6007 163.1185,36.4705 163.1185,36.145 L163.1185,35.1034 C163.1185,34.7941 163.1022,34.6965 163.0208,34.5825 C162.9069,34.3872 162.7116,34.2733 162.4837,34.2733 C162.2721,34.2733 162.1257,34.3547 161.9629,34.5825 L161.8327,34.5337 Z " fill="#FFFFFF"></path><text fill="#D2D2D2" font-family='"Verdana"' font-size="11.4583" lengthadjust="spacing" textlength="26.0417" x="188.0208" y="41.8859">Root</text><line style="stroke:#33B2E2;stroke-width:1.0416666666666667;" x1="106.25" x2="264.5833" y1="58.1299" y2="58.1299"></line><line style="stroke:#33B2E2;stroke-width:1.0416666666666667;" x1="106.25" x2="264.5833" y1="66.4632" y2="66.4632"></line><text fill="#D2D2D2" font-family='"Verdana"' font-size="11.4583" lengthadjust="spacing" textlength="131.25" x="119.7917" y="89.5991">classA(): List&lt;ClassA&gt;</text><text fill="#D2D2D2" font-family='"Verdana"' font-size="11.4583" lengthadjust="spacing" textlength="92.7083" x="119.7917" y="119.604">classB(): ClassB</text><text fill="#D2D2D2" font-family='"Verdana"' font-size="11.4583" lengthadjust="spacing" textlength="92.7083" x="119.7917" y="149.6089">classC(): ClassC</text></g><g id="link_Root_ClassA"><path codeline="13" d="M122.3815,174.8202 C122.3815,174.8202 90.3092,216.8662 90.3092,216.8662 " fill="none" id="Root-ClassA" style="stroke:#009FDB;stroke-width:3.125;"></path><polygon fill="none" points="82.7279,226.8047,89.8314,224.3625,90.3092,216.8662,83.2057,219.3083,82.7279,226.8047" style="stroke:#009FDB;stroke-width:3.125;"></polygon><polygon fill="#009FDB" points="129.9635,164.8823,122.8599,167.3239,122.3815,174.8202,129.4852,172.3786,129.9635,164.8823" style="stroke:#009FDB;stroke-width:3.125;"></polygon><text fill="#5A5A5A" font-family='"Verdana"' font-size="12.5" lengthadjust="spacing" textlength="7.2917" x="108.1221" y="193.0444">1</text><text fill="#5A5A5A" font-family='"Verdana"' font-size="12.5" lengthadjust="spacing" textlength="21.875" x="52.9318" y="207.5766">0..*</text></g><g id="link_Root_ClassB"><path codeline="14" d="M185.4167,177.3823 C185.4167,177.3823 185.4167,214.3047 185.4167,214.3047 " fill="none" id="Root-ClassB" style="stroke:#009FDB;stroke-width:3.125;"></path><polygon fill="none" points="185.4167,226.8047,189.5833,220.5547,185.4167,214.3047,181.25,220.5547,185.4167,226.8047" style="stroke:#009FDB;stroke-width:3.125;"></polygon><polygon fill="#009FDB" points="185.4167,164.8823,181.25,171.1323,185.4167,177.3823,189.5833,171.1323,185.4167,164.8823" style="stroke:#009FDB;stroke-width:3.125;"></polygon><text fill="#5A5A5A" font-family='"Verdana"' font-size="12.5" lengthadjust="spacing" textlength="7.2917" x="168.6873" y="193.0444">1</text><text fill="#5A5A5A" font-family='"Verdana"' font-size="12.5" lengthadjust="spacing" textlength="7.2917" x="167.321" y="207.5766">1</text></g><g id="link_Root_ClassC"><path codeline="15" d="M248.452,174.8201 C248.452,174.8201 280.5237,216.8663 280.5237,216.8663 " fill="none" id="Root-ClassC" style="stroke:#009FDB;stroke-width:3.125;"></path><polygon fill="none" points="288.1052,226.8047,287.6273,219.3083,280.5237,216.8663,281.0017,224.3627,288.1052,226.8047" style="stroke:#009FDB;stroke-width:3.125;"></polygon><polygon fill="#009FDB" points="240.8698,164.8823,241.3483,172.3786,248.452,174.8201,247.9735,167.3238,240.8698,164.8823" style="stroke:#009FDB;stroke-width:3.125;"></polygon><text fill="#5A5A5A" font-family='"Verdana"' font-size="12.5" lengthadjust="spacing" textlength="7.2917" x="229.2525" y="193.0444">1</text><text fill="#5A5A5A" font-family='"Verdana"' font-size="12.5" lengthadjust="spacing" textlength="7.2917" x="265.6226" y="207.5766">1</text></g></g></svg><p>Initialization happened entirely in the constructor and with interdependencies between the classes:</p>
<svg class="mermaid" aria-labelledby="chart-title-mermaid-svg chart-desc-mermaid-svg" role="img" viewbox="-50 -10 1093 1077" style="max-width: 1093px;" height="1077" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid-svg"><title id="chart-title-mermaid-svg"></title>
<desc id="chart-desc-mermaid-svg"></desc><style>#mermaid-svg {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#ccc;}#mermaid-svg .error-icon{fill:#a44141;}#mermaid-svg .error-text{fill:#ddd;stroke:#ddd;}#mermaid-svg .edge-thickness-normal{stroke-width:2px;}#mermaid-svg .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg .marker{fill:lightgrey;stroke:lightgrey;}#mermaid-svg .marker.cross{stroke:lightgrey;}#mermaid-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg .actor{stroke:#81B1DB;fill:#1f2020;}#mermaid-svg text.actor&gt;tspan{fill:lightgrey;stroke:none;}#mermaid-svg .actor-line{stroke:lightgrey;}#mermaid-svg .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:lightgrey;}#mermaid-svg .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:lightgrey;}#mermaid-svg #arrowhead path{fill:lightgrey;stroke:lightgrey;}#mermaid-svg .sequenceNumber{fill:black;}#mermaid-svg #sequencenumber{fill:lightgrey;}#mermaid-svg #crosshead path{fill:lightgrey;stroke:lightgrey;}#mermaid-svg .messageText{fill:lightgrey;stroke:lightgrey;}#mermaid-svg .labelBox{stroke:#81B1DB;fill:#1f2020;}#mermaid-svg .labelText,#mermaid-svg .labelText&gt;tspan{fill:lightgrey;stroke:none;}#mermaid-svg .loopText,#mermaid-svg .loopText&gt;tspan{fill:lightgrey;stroke:none;}#mermaid-svg .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:#81B1DB;fill:#81B1DB;}#mermaid-svg .note{stroke:hsl(180, 0%, 18.3529411765%);fill:#1b1b1e;}#mermaid-svg .noteText,#mermaid-svg .noteText&gt;tspan{fill:#6b747c;stroke:none;}#mermaid-svg .activation0{fill:hsl(180, 1.5873015873%, 28.3529411765%);stroke:#81B1DB;}#mermaid-svg .activation1{fill:hsl(180, 1.5873015873%, 28.3529411765%);stroke:#81B1DB;}#mermaid-svg .activation2{fill:hsl(180, 1.5873015873%, 28.3529411765%);stroke:#81B1DB;}#mermaid-svg .actorPopupMenu{position:absolute;}#mermaid-svg .actorPopupMenuPanel{position:absolute;fill:#1f2020;box-shadow:0px 8px 16px 0px rgba(0,0,0,0.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / 0.4));}#mermaid-svg .actor-man line{stroke:#81B1DB;fill:#1f2020;}#mermaid-svg .actor-man circle,#mermaid-svg line{stroke:#81B1DB;fill:#1f2020;stroke-width:2px;}#mermaid-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style>
<g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><g><line stroke="#999" stroke-width="0.5px" class="200" y2="1011" x2="75" y1="5" x1="75" id="actor0"></line><g id="root-0"><rect class="actor" ry="3" rx="3" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor: middle; font-size: 14px; font-weight: 400;" class="actor" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Server</tspan></text></g></g><g><line stroke="#999" stroke-width="0.5px" class="200" y2="1011" x2="275" y1="5" x1="275" id="actor1"></line><g id="root-1"><rect class="actor" ry="3" rx="3" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="200"></rect><text style="text-anchor: middle; font-size: 14px; font-weight: 400;" class="actor" alignment-baseline="central" dominant-baseline="central" y="32.5" x="275"><tspan dy="0" x="275">Root</tspan></text></g></g><g><line stroke="#999" stroke-width="0.5px" class="200" y2="1011" x2="475" y1="5" x1="475" id="actor2"></line><g id="root-2"><rect class="actor" ry="3" rx="3" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="400"></rect><text style="text-anchor: middle; font-size: 14px; font-weight: 400;" class="actor" alignment-baseline="central" dominant-baseline="central" y="32.5" x="475"><tspan dy="0" x="475">ClassA</tspan></text></g></g><g><line stroke="#999" stroke-width="0.5px" class="200" y2="1011" x2="675" y1="5" x1="675" id="actor3"></line><g id="root-3"><rect class="actor" ry="3" rx="3" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="600"></rect><text style="text-anchor: middle; font-size: 14px; font-weight: 400;" class="actor" alignment-baseline="central" dominant-baseline="central" y="32.5" x="675"><tspan dy="0" x="675">ClassB</tspan></text></g></g><g><line stroke="#999" stroke-width="0.5px" class="200" y2="1011" x2="918" y1="5" x1="918" id="actor4"></line><g id="root-4"><rect class="actor" ry="3" rx="3" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="843"></rect><text style="text-anchor: middle; font-size: 14px; font-weight: 400;" class="actor" alignment-baseline="central" dominant-baseline="central" y="32.5" x="918"><tspan dy="0" x="918">ClassC</tspan></text></g></g><defs><marker orient="auto" markerheight="12" markerwidth="12" markerunits="userSpaceOnUse" refy="5" refx="9" id="arrowhead"><path d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refy="4" refx="16" orient="auto" markerheight="8" markerwidth="15" id="crosshead"><path style="stroke-dasharray: 0, 0;" d="M 9,2 V 6 L16,4 Z" stroke-width="1px" stroke="#000000" fill="black"></path><path style="stroke-dasharray: 0, 0;" d="M 0,1 L 6,7 M 6,1 L 0,7" stroke-width="1px" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerheight="28" markerwidth="20" refy="7" refx="18" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerheight="40" markerwidth="60" refy="15" refx="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><g><rect class="activation0" ry="0" rx="0" height="860" width="10" stroke="#666" fill="#EDF2AE" y="111" x="270"></rect></g><g><rect class="activation0" ry="0" rx="0" height="42" width="10" stroke="#666" fill="#EDF2AE" y="159" x="470"></rect></g><g><rect class="activation0" ry="0" rx="0" height="178" width="10" stroke="#666" fill="#EDF2AE" y="249" x="670"></rect></g><g><rect class="activation0" ry="0" rx="0" height="452" width="10" stroke="#666" fill="#EDF2AE" y="475" x="913"></rect></g><g><rect class="activation0" ry="0" rx="0" height="136" width="10" stroke="#666" fill="#EDF2AE" y="747" x="670"></rect></g><g><rect class="activation0" ry="0" rx="0" height="44" width="10" stroke="#666" fill="#EDF2AE" y="793" x="470"></rect></g><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="175">cons()</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="111" x2="275" y1="111" x1="75"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="126" x="378">cons()</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="157" x2="475" y1="157" x1="280"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="172" x="375">classA</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="201" x2="280" y1="201" x1="470"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="216" x="478">cons()</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="247" x2="675" y1="247" x1="280"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="262" x="475">classA()</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="293" x2="280" y1="293" x1="670"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="308" x="475">classA</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="337" x2="670" y1="337" x1="280"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="352" x="573">doSomething()</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="383" x2="475" y1="383" x1="670"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="475">classB</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="427" x2="280" y1="427" x1="670"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="442" x="599">cons()</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="473" x2="918" y1="473" x1="280"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="488" x="597">classA()</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="519" x2="280" y1="519" x1="913"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="534" x="597">classA</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="563" x2="913" y1="563" x1="280"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="578" x="694">doSomething()</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="609" x2="475" y1="609" x1="913"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="624" x="597">classB()</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="655" x2="280" y1="655" x1="913"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="670" x="597">classB</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="699" x2="913" y1="699" x1="280"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="714" x="794">doSomethingElse()</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="745" x2="675" y1="745" x1="913"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="760" x="573">doAnotherThing()</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="791" x2="475" y1="791" x1="670"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="806" x="575">finishAnotherThing</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="837" x2="670" y1="837" x1="480"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="852" x="797">resultsFromSomethingElse</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="883" x2="913" y1="883" x1="680"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="898" x="597">classC</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="927" x2="280" y1="927" x1="913"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="942" x="173">root</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="971" x2="75" y1="971" x1="270"></line><g><rect class="actor" ry="3" rx="3" height="65" width="150" stroke="#666" fill="#eaeaea" y="991" x="0"></rect><text style="text-anchor: middle; font-size: 14px; font-weight: 400;" class="actor" alignment-baseline="central" dominant-baseline="central" y="1023.5" x="75"><tspan dy="0" x="75">Server</tspan></text></g><g><rect class="actor" ry="3" rx="3" height="65" width="150" stroke="#666" fill="#eaeaea" y="991" x="200"></rect><text style="text-anchor: middle; font-size: 14px; font-weight: 400;" class="actor" alignment-baseline="central" dominant-baseline="central" y="1023.5" x="275"><tspan dy="0" x="275">Root</tspan></text></g><g><rect class="actor" ry="3" rx="3" height="65" width="150" stroke="#666" fill="#eaeaea" y="991" x="400"></rect><text style="text-anchor: middle; font-size: 14px; font-weight: 400;" class="actor" alignment-baseline="central" dominant-baseline="central" y="1023.5" x="475"><tspan dy="0" x="475">ClassA</tspan></text></g><g><rect class="actor" ry="3" rx="3" height="65" width="150" stroke="#666" fill="#eaeaea" y="991" x="600"></rect><text style="text-anchor: middle; font-size: 14px; font-weight: 400;" class="actor" alignment-baseline="central" dominant-baseline="central" y="1023.5" x="675"><tspan dy="0" x="675">ClassB</tspan></text></g><g><rect class="actor" ry="3" rx="3" height="65" width="150" stroke="#666" fill="#eaeaea" y="991" x="843"></rect><text style="text-anchor: middle; font-size: 14px; font-weight: 400;" class="actor" alignment-baseline="central" dominant-baseline="central" y="1023.5" x="918"><tspan dy="0" x="918">ClassC</tspan></text></g><style>@import url("https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css");</style></svg><p>Services could (and did) refer to other services outside of their constructors, which may or may not be initialized. These methods would be called by other services <em>inside</em> their constructors.</p>
<p>Among other consequences:</p>
<ol>
<li>It meant that the order that the services were created in the constructor was extremely fragile.</li>
<li>You had no ability to know, when you added a new call to an item, if it had any dependencies that were unresolved.</li>
<li>It was completely untestable <strong>and</strong> it made new code difficult to test. This was made worse by the constructors engaging in behavior like File IO or starting threads.</li>
</ol>
<p>This company at the time was very anti-testing for a variety of reasons, but part of it was that writing tests with a system like this led to brittle tests that were difficult to write and provided minimal value.</p>
<h2 id="purpose-of-the-design">
<span class="mr-2">Purpose of the Design</span><a href="#purpose-of-the-design" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h2>
<p>The (unfulfilled) idea was that you could have various types of system all living together not just in one code base, but one <em>binary</em> and spin up a server with radically different characteristics through configuration alone.</p>
<p>This was never followed through with, but it did mean that a lot of <code class="language-plaintext highlighter-rouge">Root</code> code would end up in sometimes bizarre tools that really didn’t need to be running, say, the production user management system.</p>
<p>This was not something that anyone really wanted to keep: it was a vision that never came to fruition, and no one really thought it would ever come to be, but a lot of the design choices were predicated on this assumption.</p>
<h2 id="so-i-set-out-to-fix-it">
<span class="mr-2">So I Set Out To Fix It</span><a href="#so-i-set-out-to-fix-it" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h2>
<p>Fixing this “service locator” became a major focus for me. I wanted to convert us to dependency injection model and had chosen guice as a framework. Guice had several advantages over other systems:</p>
<ol>
<li>It required no mucking about with the build, which at that point was something incredibly perilous to change (another team was working on this problem).</li>
<li>It had support for a lot of weird edge cases, such as multibinding, circular dependencies, and things of that nature. These aren’t necessarily desireable, but they were already extant in the code and we didn’t know where all of them were.</li>
<li>It worked off the standard JSR injection patterns, which facilitate doing manual injection and make testing easier.</li>
</ol>
<p>I got a few people together who were on board, got buy-in from different parts of the org, and off we went.</p>
<h3 id="can-we-start-from-the-bottom-up">
<span class="mr-2">Can we start from the bottom up?</span><a href="#can-we-start-from-the-bottom-up" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h3>
<p>The original idea was to start at the bottom and work my way up:</p>
<svg class="statediagram" aria-labelledby="chart-title-mermaid-svg chart-desc-mermaid-svg" role="img" viewbox="0 0 435.09375 282" style="max-width: 761.4140625px;" height="282" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid-svg"><title id="chart-title-mermaid-svg"></title>
<desc id="chart-desc-mermaid-svg"></desc><style>#mermaid-svg {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#ccc;}#mermaid-svg .error-icon{fill:#a44141;}#mermaid-svg .error-text{fill:#ddd;stroke:#ddd;}#mermaid-svg .edge-thickness-normal{stroke-width:2px;}#mermaid-svg .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg .marker{fill:lightgrey;stroke:lightgrey;}#mermaid-svg .marker.cross{stroke:lightgrey;}#mermaid-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg defs #statediagram-barbEnd{fill:lightgrey;stroke:lightgrey;}#mermaid-svg g.stateGroup text{fill:#81B1DB;stroke:none;font-size:10px;}#mermaid-svg g.stateGroup text{fill:#ccc;stroke:none;font-size:10px;}#mermaid-svg g.stateGroup .state-title{font-weight:bolder;fill:#afb0b1;}#mermaid-svg g.stateGroup rect{fill:#1f2020;stroke:#81B1DB;}#mermaid-svg g.stateGroup line{stroke:lightgrey;stroke-width:1;}#mermaid-svg .transition{stroke:lightgrey;stroke-width:1;fill:none;}#mermaid-svg .stateGroup .composit{fill:#1b1b1e;border-bottom:1px;}#mermaid-svg .stateGroup .alt-composit{fill:#e0e0e0;border-bottom:1px;}#mermaid-svg .state-note{stroke:hsl(180, 0%, 18.3529411765%);fill:#1b1b1e;}#mermaid-svg .state-note text{fill:#6b747c;stroke:none;font-size:10px;}#mermaid-svg .stateLabel .box{stroke:none;stroke-width:0;fill:#1f2020;opacity:0.5;}#mermaid-svg .edgeLabel .label rect{fill:#1f2020;opacity:0.5;}#mermaid-svg .edgeLabel .label text{fill:#ccc;}#mermaid-svg .label div .edgeLabel{color:#ccc;}#mermaid-svg .stateLabel text{fill:#afb0b1;font-size:10px;font-weight:bold;}#mermaid-svg .node circle.state-start{fill:#f4f4f4;stroke:#f4f4f4;}#mermaid-svg .node .fork-join{fill:#f4f4f4;stroke:#f4f4f4;}#mermaid-svg .node circle.state-end{fill:#cccccc;stroke:#1b1b1e;stroke-width:1.5;}#mermaid-svg .end-state-inner{fill:#1b1b1e;stroke-width:1.5;}#mermaid-svg .node rect{fill:#1f2020;stroke:#81B1DB;stroke-width:1px;}#mermaid-svg .node polygon{fill:#1f2020;stroke:#81B1DB;stroke-width:1px;}#mermaid-svg #statediagram-barbEnd{fill:lightgrey;}#mermaid-svg .statediagram-cluster rect{fill:#1f2020;stroke:#81B1DB;stroke-width:1px;}#mermaid-svg .cluster-label,#mermaid-svg .nodeLabel{color:#afb0b1;}#mermaid-svg .statediagram-cluster rect.outer{rx:5px;ry:5px;}#mermaid-svg .statediagram-state .divider{stroke:#81B1DB;}#mermaid-svg .statediagram-state .title-state{rx:5px;ry:5px;}#mermaid-svg .statediagram-cluster.statediagram-cluster .inner{fill:#1b1b1e;}#mermaid-svg .statediagram-cluster.statediagram-cluster-alt .inner{fill:#555;}#mermaid-svg .statediagram-cluster .inner{rx:0;ry:0;}#mermaid-svg .statediagram-state rect.basic{rx:5px;ry:5px;}#mermaid-svg .statediagram-state rect.divider{stroke-dasharray:10,10;fill:#555;}#mermaid-svg .note-edge{stroke-dasharray:5;}#mermaid-svg .statediagram-note rect{fill:#1b1b1e;stroke:hsl(180, 0%, 18.3529411765%);stroke-width:1px;rx:0;ry:0;}#mermaid-svg .statediagram-note rect{fill:#1b1b1e;stroke:hsl(180, 0%, 18.3529411765%);stroke-width:1px;rx:0;ry:0;}#mermaid-svg .statediagram-note text{fill:#6b747c;}#mermaid-svg .statediagram-note .nodeLabel{color:#6b747c;}#mermaid-svg .statediagram .edgeLabel{color:red;}#mermaid-svg #dependencyStart,#mermaid-svg #dependencyEnd{fill:lightgrey;stroke:lightgrey;stroke-width:1;}#mermaid-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style>
<g><defs><marker orient="auto" markerunits="strokeWidth" markerheight="14" markerwidth="20" refy="7" refx="19" id="statediagram-barbEnd"><path d="M 19,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#statediagram-barbEnd)" style="fill:none" class="edge-thickness-normal transition" id="edge0" d="M217.546875,22L217.546875,26.166666666666668C217.546875,30.333333333333332,217.546875,38.666666666666664,217.546875,47C217.546875,55.333333333333336,217.546875,63.666666666666664,217.546875,67.83333333333333L217.546875,72"></path><path marker-end="url(#statediagram-barbEnd)" style="fill:none" class="edge-thickness-normal transition" id="edge1" d="M188.84830729166666,106L181.81434461805554,110.16666666666667C174.78038194444443,114.33333333333333,160.7124565972222,122.66666666666667,153.67849392361111,131C146.64453125,139.33333333333334,146.64453125,147.66666666666666,146.64453125,151.83333333333334L146.64453125,156"></path><path marker-end="url(#statediagram-barbEnd)" style="fill:none" class="edge-thickness-normal transition" id="edge2" d="M146.64453125,190L146.64453125,194.16666666666666C146.64453125,198.33333333333334,146.64453125,206.66666666666666,153.67849392361111,215C160.7124565972222,223.33333333333334,174.78038194444443,231.66666666666666,181.81434461805554,235.83333333333334L188.84830729166666,240"></path><path marker-end="url(#statediagram-barbEnd)" style="fill:none" class="edge-thickness-normal transition" id="edge3" d="M246.24544270833334,240L253.27940538194446,235.83333333333334C260.3133680555556,231.66666666666666,274.38129340277777,223.33333333333334,281.41525607638886,212.16666666666666C288.44921875,201,288.44921875,187,288.44921875,173C288.44921875,159,288.44921875,145,281.41525607638886,133.83333333333334C274.38129340277777,122.66666666666667,260.3133680555556,114.33333333333333,253.27940538194446,110.16666666666667L246.24544270833334,106"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"></rect><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"></rect><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"></rect><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"></rect><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g></g><g class="nodes"><g transform="translate(217.546875, 15)" id="state-root_start-0" class="node default"><circle height="14" width="14" r="7" class="state-start"></circle></g><g transform="translate(217.546875, 89)" id="state-A-4" class="node statediagram-state"><rect height="34" width="419.09375" y="-17" x="-209.546875" style="" class="basic label-container"></rect><g transform="translate(-202.046875, -9.5)" style="" class="label"><foreignobject height="19" width="404.09375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Find a point with no dependencies (that aren't injected)</span></div></foreignobject></g></g><g transform="translate(146.64453125, 173)" id="state-B-4" class="node statediagram-state"><rect height="34" width="213.609375" y="-17" x="-106.8046875" style="" class="basic label-container"></rect><g transform="translate(-99.3046875, -9.5)" style="" class="label"><foreignobject height="19" width="198.609375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Replace it with the injector</span></div></foreignobject></g></g><g transform="translate(217.546875, 257)" id="state-C-4" class="node statediagram-state"><rect height="34" width="388.328125" y="-17" x="-194.1640625" style="" class="basic label-container"></rect><g transform="translate(-186.6640625, -9.5)" style="" class="label"><foreignobject height="19" width="373.328125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Initialize complex behavior in an initialize() method</span></div></foreignobject></g></g></g></g></g><style>@import url("https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css");</style></svg><p>Where possible, it would also help to bring pieces into a test harness, even if we couldn’t write any tests for them yet.</p>
<p>This approach, which focused on the <em>degree of coupling</em>, had several advantages:</p>
<ul>
<li>
<strong>Minimally Invasive</strong> By starting with the lowest pieces of the puzzle and working up meant that, especially at first, the components did not need excess dependencies and the modules could be kept relatively simple. Also it meant that each individual code change would be small and would be unlikely to impact anyone who wasn’t working on that exact class.</li>
<li>
<strong>Fast Benefit</strong> It could be done in small pieces—two hours here, a day there—rather than requiring a large amount of work up front.</li>
<li>
<strong>Isolated</strong> Most of the classes that fit this description were not in the critical path <em>per se</em>, or were in the critical path but their instantiation and teardown were not in the crtitical path. This meant that we could make the changes without radically altering the performance or memory characteristics of the system so that we could prove that we wouldn’t impact things too badly before moving to the more critical path components.</li>
</ul>
<p>The limitations, however, quickly became apparant as well:</p>
<ol>
<li>Because of the mass of <strong>interrelated dependencies</strong>, we ended up needing multiple injectors that we would build on in later steps.</li>
<li>It turns out that the criteria for this actually came out to <strong>very few cases</strong>. Adding additional cases got more and more difficult, particularly as we started encountering classes with 15+ dependencies.</li>
<li>It was actually fairly difficult to <strong>map how many dependencies</strong> a given class had. Because of the problem of <code class="language-plaintext highlighter-rouge">A</code> would call <code class="language-plaintext highlighter-rouge">B</code> during the instantiation process of <code class="language-plaintext highlighter-rouge">C</code>, and because there was a lot of code that would do: <code class="language-plaintext highlighter-rouge">root.getA().getB().getC().doSomething()</code> finding which class to pick next was relatively challenging.</li>
</ol>
<p>But the real kicker was this:</p>
<div class="indented"><p>People who were doing development would often reach for a tool that was on <code class="language-plaintext highlighter-rouge">Root</code> but then get confused on “how to add it the right way.” They would add dependencies that were not ready to be brought in, and this meant that the <strong>entire class would need to be revisited</strong>.</p></div>
<p>This also meant that rather than doing dependency injection, a lot of classes would end up with a hodgepodge of dependency injection and service lookups… and we were inadvertantly encouraging them to make <em>more</em> of a hodgepodge going forward rather than encouraging other developers to clean things up.</p>
<p>We had created a situation where there were pretty much two people who could actually improve the health of the code and drive the project forward.</p>
<p>This was, suffice it to say, undesireable.</p>
<h3 id="enter-project-root-canal">
<span class="mr-2">Enter Project Root Canal</span><a href="#enter-project-root-canal" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h3>
<p>Instead of going at it from the bottom up, what if we went at it from the top down? Focusing on the <em>order of initialization</em> rather than the <em>degree of coupling</em>.</p>
<p>Basically:</p>
<svg class="statediagram" aria-labelledby="chart-title-mermaid-svg chart-desc-mermaid-svg" role="img" viewbox="0 0 495.19140625 282" style="max-width: 866.5849609375px;" height="282" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid-svg"><title id="chart-title-mermaid-svg"></title>
<desc id="chart-desc-mermaid-svg"></desc><style>#mermaid-svg {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#ccc;}#mermaid-svg .error-icon{fill:#a44141;}#mermaid-svg .error-text{fill:#ddd;stroke:#ddd;}#mermaid-svg .edge-thickness-normal{stroke-width:2px;}#mermaid-svg .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg .marker{fill:lightgrey;stroke:lightgrey;}#mermaid-svg .marker.cross{stroke:lightgrey;}#mermaid-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg defs #statediagram-barbEnd{fill:lightgrey;stroke:lightgrey;}#mermaid-svg g.stateGroup text{fill:#81B1DB;stroke:none;font-size:10px;}#mermaid-svg g.stateGroup text{fill:#ccc;stroke:none;font-size:10px;}#mermaid-svg g.stateGroup .state-title{font-weight:bolder;fill:#afb0b1;}#mermaid-svg g.stateGroup rect{fill:#1f2020;stroke:#81B1DB;}#mermaid-svg g.stateGroup line{stroke:lightgrey;stroke-width:1;}#mermaid-svg .transition{stroke:lightgrey;stroke-width:1;fill:none;}#mermaid-svg .stateGroup .composit{fill:#1b1b1e;border-bottom:1px;}#mermaid-svg .stateGroup .alt-composit{fill:#e0e0e0;border-bottom:1px;}#mermaid-svg .state-note{stroke:hsl(180, 0%, 18.3529411765%);fill:#1b1b1e;}#mermaid-svg .state-note text{fill:#6b747c;stroke:none;font-size:10px;}#mermaid-svg .stateLabel .box{stroke:none;stroke-width:0;fill:#1f2020;opacity:0.5;}#mermaid-svg .edgeLabel .label rect{fill:#1f2020;opacity:0.5;}#mermaid-svg .edgeLabel .label text{fill:#ccc;}#mermaid-svg .label div .edgeLabel{color:#ccc;}#mermaid-svg .stateLabel text{fill:#afb0b1;font-size:10px;font-weight:bold;}#mermaid-svg .node circle.state-start{fill:#f4f4f4;stroke:#f4f4f4;}#mermaid-svg .node .fork-join{fill:#f4f4f4;stroke:#f4f4f4;}#mermaid-svg .node circle.state-end{fill:#cccccc;stroke:#1b1b1e;stroke-width:1.5;}#mermaid-svg .end-state-inner{fill:#1b1b1e;stroke-width:1.5;}#mermaid-svg .node rect{fill:#1f2020;stroke:#81B1DB;stroke-width:1px;}#mermaid-svg .node polygon{fill:#1f2020;stroke:#81B1DB;stroke-width:1px;}#mermaid-svg #statediagram-barbEnd{fill:lightgrey;}#mermaid-svg .statediagram-cluster rect{fill:#1f2020;stroke:#81B1DB;stroke-width:1px;}#mermaid-svg .cluster-label,#mermaid-svg .nodeLabel{color:#afb0b1;}#mermaid-svg .statediagram-cluster rect.outer{rx:5px;ry:5px;}#mermaid-svg .statediagram-state .divider{stroke:#81B1DB;}#mermaid-svg .statediagram-state .title-state{rx:5px;ry:5px;}#mermaid-svg .statediagram-cluster.statediagram-cluster .inner{fill:#1b1b1e;}#mermaid-svg .statediagram-cluster.statediagram-cluster-alt .inner{fill:#555;}#mermaid-svg .statediagram-cluster .inner{rx:0;ry:0;}#mermaid-svg .statediagram-state rect.basic{rx:5px;ry:5px;}#mermaid-svg .statediagram-state rect.divider{stroke-dasharray:10,10;fill:#555;}#mermaid-svg .note-edge{stroke-dasharray:5;}#mermaid-svg .statediagram-note rect{fill:#1b1b1e;stroke:hsl(180, 0%, 18.3529411765%);stroke-width:1px;rx:0;ry:0;}#mermaid-svg .statediagram-note rect{fill:#1b1b1e;stroke:hsl(180, 0%, 18.3529411765%);stroke-width:1px;rx:0;ry:0;}#mermaid-svg .statediagram-note text{fill:#6b747c;}#mermaid-svg .statediagram-note .nodeLabel{color:#6b747c;}#mermaid-svg .statediagram .edgeLabel{color:red;}#mermaid-svg #dependencyStart,#mermaid-svg #dependencyEnd{fill:lightgrey;stroke:lightgrey;stroke-width:1;}#mermaid-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style>
<g><defs><marker orient="auto" markerunits="strokeWidth" markerheight="14" markerwidth="20" refy="7" refx="19" id="statediagram-barbEnd"><path d="M 19,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#statediagram-barbEnd)" style="fill:none" class="edge-thickness-normal transition" id="edge0" d="M270.87890625,22L270.87890625,26.166666666666668C270.87890625,30.333333333333332,270.87890625,38.666666666666664,270.87890625,47C270.87890625,55.333333333333336,270.87890625,63.666666666666664,270.87890625,67.83333333333333L270.87890625,72"></path><path marker-end="url(#statediagram-barbEnd)" style="fill:none" class="edge-thickness-normal transition" id="edge1" d="M230.68889508928572,106L220.8384021577381,110.16666666666667C210.98790922619048,114.33333333333333,191.28692336309527,122.66666666666667,181.43643043154762,131C171.5859375,139.33333333333334,171.5859375,147.66666666666666,171.5859375,151.83333333333334L171.5859375,156"></path><path marker-end="url(#statediagram-barbEnd)" style="fill:none" class="edge-thickness-normal transition" id="edge2" d="M171.5859375,190L171.5859375,194.16666666666666C171.5859375,198.33333333333334,171.5859375,206.66666666666666,181.43643043154762,215C191.28692336309527,223.33333333333334,210.98790922619048,231.66666666666666,220.8384021577381,235.83333333333334L230.68889508928572,240"></path><path marker-end="url(#statediagram-barbEnd)" style="fill:none" class="edge-thickness-normal transition" id="edge3" d="M311.0689174107143,240L320.91941034226187,235.83333333333334C330.7699032738095,231.66666666666666,350.47088913690476,223.33333333333334,360.32138206845235,212.16666666666666C370.171875,201,370.171875,187,370.171875,173C370.171875,159,370.171875,145,360.32138206845235,133.83333333333334C350.47088913690476,122.66666666666667,330.7699032738095,114.33333333333333,320.91941034226187,110.16666666666667L311.0689174107143,106"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"></rect><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"></rect><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"></rect><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"></rect><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g></g><g class="nodes"><g transform="translate(270.87890625, 15)" id="state-root_start-0" class="node default"><circle height="14" width="14" r="7" class="state-start"></circle></g><g transform="translate(270.87890625, 89)" id="state-A-4" class="node statediagram-state"><rect height="34" width="432.625" y="-17" x="-216.3125" style="" class="basic label-container"></rect><g transform="translate(-208.8125, -9.5)" style="" class="label"><foreignobject height="19" width="417.625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Find a point with no (uninjected) initialized dependencies</span></div></foreignobject></g></g><g transform="translate(171.5859375, 173)" id="state-B-4" class="node statediagram-state"><rect height="34" width="327.171875" y="-17" x="-163.5859375" style="" class="basic label-container"></rect><g transform="translate(-156.0859375, -9.5)" style="" class="label"><foreignobject height="19" width="312.171875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Convert it entirely to dependency injection</span></div></foreignobject></g></g><g transform="translate(270.87890625, 257)" id="state-C-4" class="node statediagram-state"><rect height="34" width="388.328125" y="-17" x="-194.1640625" style="" class="basic label-container"></rect><g transform="translate(-186.6640625, -9.5)" style="" class="label"><foreignobject height="19" width="373.328125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Initialize complex behavior in an initialize() method</span></div></foreignobject></g></g></g></g></g><style>@import url("https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css");</style></svg><p>This also gave us an opportunity, because most of these <em>needed to be</em> initialized, to wrap a lot of the tooling in <a href="https://github.com/google/guava/wiki/ServiceExplained">Guava services</a>, which gave us better error handling and lifecycle management.</p>
<p>Dependencies that were not ready to be converted to DI wholesale could still inject <code class="language-plaintext highlighter-rouge">Root</code> and use that object, giving a stopgap measure to keep us from having to convert the entire system in one throw.</p>
<p>Basically:</p>
<ol>
<li>Rather than start at the bottom and work our way up, we were starting at the top and working our way down.</li>
<li>Rather than attempting to <em>eliminate</em> the Root object <em>per se</em>, we were hollowing it out and turning it into a wrapper for the initialization.</li>
</ol>
<p>The outer structure of <code class="language-plaintext highlighter-rouge">Root</code> would remain exactly the same, but the inner structure of it became something simpler.</p>
<p>Having decided on a course of action, the initial work to get the basic framework in place took around two weeks. This kicked off the iterative process–which took months–of moving every component over to the new system.</p>
<h3 id="making-it-readable">
<span class="mr-2">Making it Readable</span><a href="#making-it-readable" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h3>
<p>Guice has a reputation for making code hard to read. This is especially true when it is used in highly complex ways, with architectures that involve lots of options in their module configurations (what is <code class="language-plaintext highlighter-rouge">Foo</code> bound to? who can say!). We adopted several principles in this design to make sure that we didn’t end up in a worse position than where we started:</p>
<ol>
<li>Every package should contain exactly one (1) <code class="language-plaintext highlighter-rouge">public</code> module. No bindings should reach outside of their module if it is possible to avoid it (no <code class="language-plaintext highlighter-rouge">impl</code> packages). There was some flexibility on this point for multibindings. By convention this <code class="language-plaintext highlighter-rouge">public</code> module was named <code class="language-plaintext highlighter-rouge">&lt;Package&gt;Module</code>.</li>
<li>Every package was responsible, within its <code class="language-plaintext highlighter-rouge">public</code> module, for injecting the modules of child packages. There were a handful of exceptions to this, but we tried to make them as explicit as possible. What this meant was that, combined with (1), even if the <em>classes</em> had dependencies all over the place, the <em>modules</em> would form a tree that was identical to the package hierarchy.</li>
<li>Modules should contain no <a href="https://github.com/google/guice/wiki/AvoidConditionalLogicInModules">conditional logic</a>, with only a handful of exceptions.</li>
<li>Everything should be as explicit as possible: no implicit bindings, always use <code class="language-plaintext highlighter-rouge">@Inject</code> on constructors, and try to follow the <a href="https://en.wikipedia.org/wiki/Law_of_Demeter">Law of Demeter</a> <a class="citation" href="#law-of-demeter">[1]</a>.</li>
<li>All binding logic should be inside of the modules and their associated <code class="language-plaintext highlighter-rouge">Provider</code>s. No using <code class="language-plaintext highlighter-rouge">@ImplementedBy</code> or <code class="language-plaintext highlighter-rouge">@ProvidedBy</code>.</li>
</ol>
<p>The goal here was to simplify what we could in guice and make it as simple as possible to find and diagnose problems. You should never have to wonder “where was this bound.” If you wanted to know the implementation for <code class="language-plaintext highlighter-rouge">com.example.foo.Bar</code> you looked for <code class="language-plaintext highlighter-rouge">com.example.foo.FooModule</code> as a starting point, and you knew it had to be bound <em>somewhere</em> within a <code class="language-plaintext highlighter-rouge">Module</code> inside of <code class="language-plaintext highlighter-rouge">com.example.foo</code>. This limited the search scope to a handful of classes, usually only one or two.</p>
<p>Using these rules, you could pretty much always find the implementation of a given object with <code class="language-plaintext highlighter-rouge">grep</code> or by hand, if need be.</p>
<p>It also simplified reasoning about the module layout if you always knew that <code class="language-plaintext highlighter-rouge">com.example.foo.FooModule</code> would always inject <code class="language-plaintext highlighter-rouge">com.example.foo.bar.BarModule</code> and <code class="language-plaintext highlighter-rouge">com.example.foo.baz.BazModule</code>.</p>
<h3 id="getting-others-on-board">
<span class="mr-2">Getting Others On Board</span><a href="#getting-others-on-board" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h3>
<p>There’s a lot more to making a change of this scale and scope than just the technical work of migrating the code. A lot of other things had to start happening simultaneously, and ultimately the success of a project like this depends on more than a small group working on it. We needed to get everyone to join in on the process.</p>
<p>Many of the developers had started their careers with this system and only had peripheral knowledge of dependency injection as a set of principles. This necessitated a lot of different approaches to try to make sure that the ideas were widely disseminated:</p>
<ol>
<li>Holding small group workshops with practice and discussion elements.</li>
<li>Larger sessions that were more theory focused.</li>
<li>Providing resources in the form of books, articles, and the like.</li>
<li>One-on-one work with individuals, especially with help debugging or tracking down problems.</li>
<li>Copious code reviews.</li>
</ol>
<p>It also required clearing up some misconceptions:</p>
<ol>
<li>That “dependency injection” is a framework. Essentially thinking that DI = Spring, Guice, Dagger, etc.</li>
<li>That merely being instantiated with guice would significantly alter the runtime performance characteristics.</li>
<li>That this was the end of the journey and after this we would be in a magical place.</li>
</ol>
<h3 id="now-for-the-test-harness">
<span class="mr-2">Now for the Test Harness</span><a href="#now-for-the-test-harness" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h3>
<p>Meanwhile, a senior <span class="hoverover" data-toggle="tooltip" data-placemet="top" title="Software Development Engineer in Test">SDET</span> had been working on trying to get the entire thing into an integration test harness that could run against a known database.</p>
<p>To do this, we made sure that there were tools in place that allowed them to swap out the injector in test and we prioritized those pieces that did things that were really undesireable in a testing situation. Things like interacting with a database or opening a network socket inside of a constructor. As much as possile we tried to move these into guava services that we could initialize separately from their construction.</p>
<p>Now whenever someone would instantiate the service, a series of steps took place that most programmers never had to worry about or deal with:</p>
<svg class="statediagram" aria-labelledby="chart-title-mermaid-svg chart-desc-mermaid-svg" role="img" viewbox="0 0 253.375 552" style="max-width: 443.40625px;" height="552" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid-svg"><title id="chart-title-mermaid-svg"></title>
<desc id="chart-desc-mermaid-svg"></desc><style>#mermaid-svg {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#ccc;}#mermaid-svg .error-icon{fill:#a44141;}#mermaid-svg .error-text{fill:#ddd;stroke:#ddd;}#mermaid-svg .edge-thickness-normal{stroke-width:2px;}#mermaid-svg .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg .marker{fill:lightgrey;stroke:lightgrey;}#mermaid-svg .marker.cross{stroke:lightgrey;}#mermaid-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg defs #statediagram-barbEnd{fill:lightgrey;stroke:lightgrey;}#mermaid-svg g.stateGroup text{fill:#81B1DB;stroke:none;font-size:10px;}#mermaid-svg g.stateGroup text{fill:#ccc;stroke:none;font-size:10px;}#mermaid-svg g.stateGroup .state-title{font-weight:bolder;fill:#afb0b1;}#mermaid-svg g.stateGroup rect{fill:#1f2020;stroke:#81B1DB;}#mermaid-svg g.stateGroup line{stroke:lightgrey;stroke-width:1;}#mermaid-svg .transition{stroke:lightgrey;stroke-width:1;fill:none;}#mermaid-svg .stateGroup .composit{fill:#1b1b1e;border-bottom:1px;}#mermaid-svg .stateGroup .alt-composit{fill:#e0e0e0;border-bottom:1px;}#mermaid-svg .state-note{stroke:hsl(180, 0%, 18.3529411765%);fill:#1b1b1e;}#mermaid-svg .state-note text{fill:#6b747c;stroke:none;font-size:10px;}#mermaid-svg .stateLabel .box{stroke:none;stroke-width:0;fill:#1f2020;opacity:0.5;}#mermaid-svg .edgeLabel .label rect{fill:#1f2020;opacity:0.5;}#mermaid-svg .edgeLabel .label text{fill:#ccc;}#mermaid-svg .label div .edgeLabel{color:#ccc;}#mermaid-svg .stateLabel text{fill:#afb0b1;font-size:10px;font-weight:bold;}#mermaid-svg .node circle.state-start{fill:#f4f4f4;stroke:#f4f4f4;}#mermaid-svg .node .fork-join{fill:#f4f4f4;stroke:#f4f4f4;}#mermaid-svg .node circle.state-end{fill:#cccccc;stroke:#1b1b1e;stroke-width:1.5;}#mermaid-svg .end-state-inner{fill:#1b1b1e;stroke-width:1.5;}#mermaid-svg .node rect{fill:#1f2020;stroke:#81B1DB;stroke-width:1px;}#mermaid-svg .node polygon{fill:#1f2020;stroke:#81B1DB;stroke-width:1px;}#mermaid-svg #statediagram-barbEnd{fill:lightgrey;}#mermaid-svg .statediagram-cluster rect{fill:#1f2020;stroke:#81B1DB;stroke-width:1px;}#mermaid-svg .cluster-label,#mermaid-svg .nodeLabel{color:#afb0b1;}#mermaid-svg .statediagram-cluster rect.outer{rx:5px;ry:5px;}#mermaid-svg .statediagram-state .divider{stroke:#81B1DB;}#mermaid-svg .statediagram-state .title-state{rx:5px;ry:5px;}#mermaid-svg .statediagram-cluster.statediagram-cluster .inner{fill:#1b1b1e;}#mermaid-svg .statediagram-cluster.statediagram-cluster-alt .inner{fill:#555;}#mermaid-svg .statediagram-cluster .inner{rx:0;ry:0;}#mermaid-svg .statediagram-state rect.basic{rx:5px;ry:5px;}#mermaid-svg .statediagram-state rect.divider{stroke-dasharray:10,10;fill:#555;}#mermaid-svg .note-edge{stroke-dasharray:5;}#mermaid-svg .statediagram-note rect{fill:#1b1b1e;stroke:hsl(180, 0%, 18.3529411765%);stroke-width:1px;rx:0;ry:0;}#mermaid-svg .statediagram-note rect{fill:#1b1b1e;stroke:hsl(180, 0%, 18.3529411765%);stroke-width:1px;rx:0;ry:0;}#mermaid-svg .statediagram-note text{fill:#6b747c;}#mermaid-svg .statediagram-note .nodeLabel{color:#6b747c;}#mermaid-svg .statediagram .edgeLabel{color:red;}#mermaid-svg #dependencyStart,#mermaid-svg #dependencyEnd{fill:lightgrey;stroke:lightgrey;stroke-width:1;}#mermaid-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style>
<g><defs><marker orient="auto" markerunits="strokeWidth" markerheight="14" markerwidth="20" refy="7" refx="19" id="statediagram-barbEnd"><path d="M 19,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#statediagram-barbEnd)" style="fill:none" class="edge-thickness-normal transition" id="edge0" d="M126.6875,22L126.6875,26.166666666666668C126.6875,30.333333333333332,126.6875,38.666666666666664,126.6875,47C126.6875,55.333333333333336,126.6875,63.666666666666664,126.6875,67.83333333333333L126.6875,72"></path><path marker-end="url(#statediagram-barbEnd)" style="fill:none" class="edge-thickness-normal transition" id="edge1" d="M126.6875,125L126.6875,129.16666666666666C126.6875,133.33333333333334,126.6875,141.66666666666666,126.6875,150C126.6875,158.33333333333334,126.6875,166.66666666666666,126.6875,170.83333333333334L126.6875,175"></path><path marker-end="url(#statediagram-barbEnd)" style="fill:none" class="edge-thickness-normal transition" id="edge2" d="M126.6875,209L126.6875,213.16666666666666C126.6875,217.33333333333334,126.6875,225.66666666666666,126.6875,234C126.6875,242.33333333333334,126.6875,250.66666666666666,126.6875,254.83333333333334L126.6875,259"></path><path marker-end="url(#statediagram-barbEnd)" style="fill:none" class="edge-thickness-normal transition" id="edge3" d="M126.6875,293L126.6875,297.1666666666667C126.6875,301.3333333333333,126.6875,309.6666666666667,126.6875,318C126.6875,326.3333333333333,126.6875,334.6666666666667,126.6875,338.8333333333333L126.6875,343"></path><path marker-end="url(#statediagram-barbEnd)" style="fill:none" class="edge-thickness-normal transition" id="edge4" d="M126.6875,377L126.6875,381.1666666666667C126.6875,385.3333333333333,126.6875,393.6666666666667,126.6875,402C126.6875,410.3333333333333,126.6875,418.6666666666667,126.6875,422.8333333333333L126.6875,427"></path><path marker-end="url(#statediagram-barbEnd)" style="fill:none" class="edge-thickness-normal transition" id="edge5" d="M126.6875,480L126.6875,484.1666666666667C126.6875,488.3333333333333,126.6875,496.6666666666667,126.6875,505C126.6875,513.3333333333334,126.6875,521.6666666666666,126.6875,525.8333333333334L126.6875,530"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"></rect><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"></rect><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"></rect><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"></rect><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"></rect><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"></rect><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g></g><g class="nodes"><g transform="translate(126.6875, 15)" id="state-root_start-0" class="node default"><circle height="14" width="14" r="7" class="state-start"></circle></g><g transform="translate(126.6875, 98.5)" id="state-CollectModules-6" class="node statediagram-state"><rect height="53" width="189.578125" y="-26.5" x="-94.7890625" style="" class="basic label-container"></rect><g transform="translate(-87.2890625, -19)" style="" class="label"><foreignobject height="38" width="174.578125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Build the set of modules<br>we were going to use</span></div></foreignobject></g></g><g transform="translate(126.6875, 192)" id="state-CreateInjector-6" class="node statediagram-state"><rect height="34" width="196.21875" y="-17" x="-98.109375" style="" class="basic label-container"></rect><g transform="translate(-90.609375, -9.5)" style="" class="label"><foreignobject height="19" width="181.21875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Create the guice injector</span></div></foreignobject></g></g><g transform="translate(126.6875, 276)" id="state-BuildServiceManager-6" class="node statediagram-state"><rect height="34" width="202.078125" y="-17" x="-101.0390625" style="" class="basic label-container"></rect><g transform="translate(-93.5390625, -9.5)" style="" class="label"><foreignobject height="19" width="187.078125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Inject the ServiceManager</span></div></foreignobject></g></g><g transform="translate(126.6875, 360)" id="state-StartAsync-6" class="node statediagram-state"><rect height="34" width="195.03125" y="-17" x="-97.515625" style="" class="basic label-container"></rect><g transform="translate(-90.015625, -9.5)" style="" class="label"><foreignobject height="19" width="180.03125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Start the ServiceManager</span></div></foreignobject></g></g><g transform="translate(126.6875, 453.5)" id="state-AwaitHealthy-6" class="node statediagram-state"><rect height="53" width="237.375" y="-26.5" x="-118.6875" style="" class="basic label-container"></rect><g transform="translate(-111.1875, -19)" style="" class="label"><foreignobject height="38" width="222.375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Wait for the ServiceManager to<br>reach a healthy state</span></div></foreignobject></g></g><g transform="translate(126.6875, 537)" id="state-root_end-5" class="node default"><circle height="14" width="14" r="7" class="state-start"></circle><circle height="10" width="10" r="5" class="state-end"></circle></g></g></g></g><style>@import url("https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css");</style></svg><p>With that done we could add a few static methods that allowed us to swap out the modules and we were good to go.</p>
<h3 id="well-almost">
<span class="mr-2">Well, Almost</span><a href="#well-almost" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h3>
<p>Turns out that people have a strong reflex when they see a class that looks like this:</p>
<div class="language-java highlighter-rouge">
<div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button>
</div>
<div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td>
<td class="rouge-code"><pre><span class="nc">Foo</span><span class="o">(</span><span class="nc">Root</span> <span class="n">root</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">this</span><span class="o">.</span><span class="na">root</span> <span class="o">=</span> <span class="n">root</span><span class="o">;</span>
<span class="o">}</span>
</pre></td>
</tr></tbody></table></code></div>
</div>
<p>Become this:</p>
<div class="language-java highlighter-rouge">
<div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button>
</div>
<div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td>
<td class="rouge-code"><pre><span class="nd">@Inject</span>
<span class="nc">Foo</span><span class="o">(</span>
  <span class="nc">DependencyA</span> <span class="n">a</span><span class="o">,</span>
  <span class="nc">DependencyB</span> <span class="n">b</span><span class="o">,</span>
  <span class="nc">DependencyC</span> <span class="n">c</span><span class="o">,</span>
  <span class="nc">DependencyD</span> <span class="n">d</span><span class="o">,</span>
  <span class="c1">//12 more dependencies</span>
  <span class="nc">DependencyQ</span> <span class="n">q</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></td>
</tr></tbody></table></code></div>
</div>
<p>They have some understandable twitch reactions and second thoughts.</p>
<p>The thing was that, by and large, those dependencies were preexisting. It’s just that previously they happened deeper in the code when <code class="language-plaintext highlighter-rouge">root.getQ()</code> was called. It wasn’t adding dependencies, instead it was revealing the dependencies that already existed.</p>
<h3 id="refinements-and-iterations">
<span class="mr-2">Refinements and Iterations</span><a href="#refinements-and-iterations" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h3>
<p>Through this we had several missteps or learning experiences along the way that caused reevaluation and backtracking or doing things differently.</p>
<h4 id="multiple-injectors">
<span class="mr-2">Multiple Injectors</span><a href="#multiple-injectors" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h4>
<p>Our early efforts involved building multiple, <a href="https://google.github.io/guice/api-docs/4.2/javadoc/com/google/inject/Injector.html#createChildInjector-java.lang.Iterable-">chained injectors</a>. This was done because fo the early design philosophy of starting at the bottom and working our way up, as we often had to deal with situations where a (non-injected) object needed to use the result of injection before something else (that was injected) could be built.</p>
<svg class="statediagram" aria-labelledby="chart-title-mermaid-svg chart-desc-mermaid-svg" role="img" viewbox="0.5 0 434.953125 976" style="max-width: 761.16796875px;" height="976" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid-svg"><title id="chart-title-mermaid-svg"></title>
<desc id="chart-desc-mermaid-svg"></desc><style>#mermaid-svg {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#ccc;}#mermaid-svg .error-icon{fill:#a44141;}#mermaid-svg .error-text{fill:#ddd;stroke:#ddd;}#mermaid-svg .edge-thickness-normal{stroke-width:2px;}#mermaid-svg .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg .marker{fill:lightgrey;stroke:lightgrey;}#mermaid-svg .marker.cross{stroke:lightgrey;}#mermaid-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg defs #statediagram-barbEnd{fill:lightgrey;stroke:lightgrey;}#mermaid-svg g.stateGroup text{fill:#81B1DB;stroke:none;font-size:10px;}#mermaid-svg g.stateGroup text{fill:#ccc;stroke:none;font-size:10px;}#mermaid-svg g.stateGroup .state-title{font-weight:bolder;fill:#afb0b1;}#mermaid-svg g.stateGroup rect{fill:#1f2020;stroke:#81B1DB;}#mermaid-svg g.stateGroup line{stroke:lightgrey;stroke-width:1;}#mermaid-svg .transition{stroke:lightgrey;stroke-width:1;fill:none;}#mermaid-svg .stateGroup .composit{fill:#1b1b1e;border-bottom:1px;}#mermaid-svg .stateGroup .alt-composit{fill:#e0e0e0;border-bottom:1px;}#mermaid-svg .state-note{stroke:hsl(180, 0%, 18.3529411765%);fill:#1b1b1e;}#mermaid-svg .state-note text{fill:#6b747c;stroke:none;font-size:10px;}#mermaid-svg .stateLabel .box{stroke:none;stroke-width:0;fill:#1f2020;opacity:0.5;}#mermaid-svg .edgeLabel .label rect{fill:#1f2020;opacity:0.5;}#mermaid-svg .edgeLabel .label text{fill:#ccc;}#mermaid-svg .label div .edgeLabel{color:#ccc;}#mermaid-svg .stateLabel text{fill:#afb0b1;font-size:10px;font-weight:bold;}#mermaid-svg .node circle.state-start{fill:#f4f4f4;stroke:#f4f4f4;}#mermaid-svg .node .fork-join{fill:#f4f4f4;stroke:#f4f4f4;}#mermaid-svg .node circle.state-end{fill:#cccccc;stroke:#1b1b1e;stroke-width:1.5;}#mermaid-svg .end-state-inner{fill:#1b1b1e;stroke-width:1.5;}#mermaid-svg .node rect{fill:#1f2020;stroke:#81B1DB;stroke-width:1px;}#mermaid-svg .node polygon{fill:#1f2020;stroke:#81B1DB;stroke-width:1px;}#mermaid-svg #statediagram-barbEnd{fill:lightgrey;}#mermaid-svg .statediagram-cluster rect{fill:#1f2020;stroke:#81B1DB;stroke-width:1px;}#mermaid-svg .cluster-label,#mermaid-svg .nodeLabel{color:#afb0b1;}#mermaid-svg .statediagram-cluster rect.outer{rx:5px;ry:5px;}#mermaid-svg .statediagram-state .divider{stroke:#81B1DB;}#mermaid-svg .statediagram-state .title-state{rx:5px;ry:5px;}#mermaid-svg .statediagram-cluster.statediagram-cluster .inner{fill:#1b1b1e;}#mermaid-svg .statediagram-cluster.statediagram-cluster-alt .inner{fill:#555;}#mermaid-svg .statediagram-cluster .inner{rx:0;ry:0;}#mermaid-svg .statediagram-state rect.basic{rx:5px;ry:5px;}#mermaid-svg .statediagram-state rect.divider{stroke-dasharray:10,10;fill:#555;}#mermaid-svg .note-edge{stroke-dasharray:5;}#mermaid-svg .statediagram-note rect{fill:#1b1b1e;stroke:hsl(180, 0%, 18.3529411765%);stroke-width:1px;rx:0;ry:0;}#mermaid-svg .statediagram-note rect{fill:#1b1b1e;stroke:hsl(180, 0%, 18.3529411765%);stroke-width:1px;rx:0;ry:0;}#mermaid-svg .statediagram-note text{fill:#6b747c;}#mermaid-svg .statediagram-note .nodeLabel{color:#6b747c;}#mermaid-svg .statediagram .edgeLabel{color:red;}#mermaid-svg #dependencyStart,#mermaid-svg #dependencyEnd{fill:lightgrey;stroke:lightgrey;stroke-width:1;}#mermaid-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style>
<g><defs><marker orient="auto" markerunits="strokeWidth" markerheight="14" markerwidth="20" refy="7" refx="19" id="statediagram-barbEnd"><path d="M 19,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#statediagram-barbEnd)" style="fill:none" class="edge-thickness-normal transition" id="edge0" d="M217.4765625,22L217.4765625,26.166666666666668C217.4765625,30.333333333333332,217.4765625,38.666666666666664,217.4765625,47C217.4765625,55.333333333333336,217.4765625,63.666666666666664,217.4765625,67.83333333333333L217.4765625,72"></path><path marker-end="url(#statediagram-barbEnd)" style="fill:none" class="edge-thickness-normal transition" id="edge10" d="M217.4765625,820L217.4765625,824.1666666666666C217.4765625,828.3333333333334,217.4765625,836.6666666666666,217.4765625,845C217.4765625,853.3333333333334,217.4765625,861.6666666666666,217.4765625,865.8333333333334L217.4765625,870"></path><path marker-end="url(#statediagram-barbEnd)" style="fill:none" class="edge-thickness-normal transition" id="edge11" d="M217.4765625,904L217.4765625,908.1666666666666C217.4765625,912.3333333333334,217.4765625,920.6666666666666,217.4765625,929C217.4765625,937.3333333333334,217.4765625,945.6666666666666,217.4765625,949.8333333333334L217.4765625,954"></path><path marker-end="url(#statediagram-barbEnd)" style="fill:none" class="edge-thickness-normal transition" id="edge1" d="M217.4765625,106L217.4765625,110.16666666666667C217.4765625,114.33333333333333,217.4765625,122.66666666666667,217.4765625,131C217.4765625,139.33333333333334,217.4765625,147.66666666666666,217.4765625,151.83333333333334L217.4765625,156"></path><path marker-end="url(#statediagram-barbEnd)" style="fill:none" class="edge-thickness-normal transition" id="edge3" d="M217.4765625,260L217.4765625,264.1666666666667C217.4765625,268.3333333333333,217.4765625,276.6666666666667,217.4765625,285C217.4765625,293.3333333333333,217.4765625,301.6666666666667,217.4765625,305.8333333333333L217.4765625,310"></path><path marker-end="url(#statediagram-barbEnd)" style="fill:none" class="edge-thickness-normal transition" id="edge4" d="M217.4765625,344L217.4765625,348.1666666666667C217.4765625,352.3333333333333,217.4765625,360.6666666666667,217.4765625,369C217.4765625,377.3333333333333,217.4765625,385.6666666666667,217.4765625,389.8333333333333L217.4765625,394"></path><path marker-end="url(#statediagram-barbEnd)" style="fill:none" class="edge-thickness-normal transition" id="edge6" d="M217.4765625,498L217.4765625,502.1666666666667C217.4765625,506.3333333333333,217.4765625,514.6666666666666,217.4765625,523C217.4765625,531.3333333333334,217.4765625,539.6666666666666,217.4765625,543.8333333333334L217.4765625,548"></path><path marker-end="url(#statediagram-barbEnd)" style="fill:none" class="edge-thickness-normal transition" id="edge7" d="M217.4765625,582L217.4765625,586.1666666666666C217.4765625,590.3333333333334,217.4765625,598.6666666666666,217.4765625,607C217.4765625,615.3333333333334,217.4765625,623.6666666666666,217.4765625,627.8333333333334L217.4765625,632"></path><path marker-end="url(#statediagram-barbEnd)" style="fill:none" class="edge-thickness-normal transition" id="edge9" d="M217.4765625,736L217.4765625,740.1666666666666C217.4765625,744.3333333333334,217.4765625,752.6666666666666,217.4765625,761C217.4765625,769.3333333333334,217.4765625,777.6666666666666,217.4765625,781.8333333333334L217.4765625,786"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"></rect><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"></rect><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"></rect><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"></rect><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"></rect><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"></rect><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"></rect><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"></rect><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"></rect><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g></g><g class="nodes"><g transform="translate(217.4765625, 15)" id="state-root_start-0" class="node default"><circle height="14" width="14" r="7" class="state-start"></circle></g><g transform="translate(217.4765625, 89)" id="state-CreateSomeObjects-1" class="node statediagram-state"><rect height="34" width="156.3125" y="-17" x="-78.15625" style="" class="basic label-container"></rect><g transform="translate(-70.65625, -9.5)" style="" class="label"><foreignobject height="19" width="141.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">CreateSomeObjects</span></div></foreignobject></g></g><g transform="translate(35.265625, 148)" class="root"><g class="clusters"><g id="OriginalInjector" class="statediagram-state statediagram-cluster"><rect height="104" width="349.421875" y="8" x="8" class="outer"></rect><g transform="translate(126.265625, 8)" class="cluster-label"><foreignobject height="19" width="112.890625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">OriginalInjector</span></div></foreignobject></g><rect height="82" width="349.421875" y="26" x="8" class="inner"></rect></g></g><g class="edgePaths"><path marker-end="url(#statediagram-barbEnd)" style="fill:none" class="edge-thickness-normal transition" id="edge2" d="M151.203125,60L155.36979166666666,60C159.53645833333334,60,167.86979166666666,60,176.203125,60C184.53645833333334,60,192.86979166666666,60,197.03645833333334,60L201.203125,60"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"></rect><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g></g><g class="nodes"><g transform="translate(92.1015625, 60)" id="state-createInjector-2" class="node statediagram-state"><rect height="34" width="118.203125" y="-17" x="-59.1015625" style="" class="basic label-container"></rect><g transform="translate(-51.6015625, -9.5)" style="" class="label"><foreignobject height="19" width="103.203125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">createInjector</span></div></foreignobject></g></g><g transform="translate(266.8125, 60)" id="state-firstServiceStart-3" class="node statediagram-state"><rect height="34" width="131.21875" y="-17" x="-65.609375" style="" class="basic label-container"></rect><g transform="translate(-58.109375, -9.5)" style="" class="label"><foreignobject height="19" width="116.21875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">firstServiceStart</span></div></foreignobject></g></g></g></g><g transform="translate(217.4765625, 327)" id="state-CreateMoreObjects-4" class="node statediagram-state"><rect height="34" width="152.90625" y="-17" x="-76.453125" style="" class="basic label-container"></rect><g transform="translate(-68.953125, -9.5)" style="" class="label"><foreignobject height="19" width="137.90625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">CreateMoreObjects</span></div></foreignobject></g></g><g transform="translate(0.5, 386)" class="root"><g class="clusters"><g id="SecondInjector" class="statediagram-state statediagram-cluster"><rect height="104" width="418.953125" y="8" x="8" class="outer"></rect><g transform="translate(163.75, 8)" class="cluster-label"><foreignobject height="19" width="107.453125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">SecondInjector</span></div></foreignobject></g><rect height="82" width="418.953125" y="26" x="8" class="inner"></rect></g></g><g class="edgePaths"><path marker-end="url(#statediagram-barbEnd)" style="fill:none" class="edge-thickness-normal transition" id="edge5" d="M196.109375,60L200.27604166666666,60C204.44270833333334,60,212.77604166666666,60,221.109375,60C229.44270833333334,60,237.77604166666666,60,241.94270833333334,60L246.109375,60"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"></rect><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g></g><g class="nodes"><g transform="translate(114.5546875, 60)" id="state-createChildInjector1-5" class="node statediagram-state"><rect height="34" width="163.109375" y="-17" x="-81.5546875" style="" class="basic label-container"></rect><g transform="translate(-74.0546875, -9.5)" style="" class="label"><foreignobject height="19" width="148.109375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">createChildInjector1</span></div></foreignobject></g></g><g transform="translate(324.03125, 60)" id="state-randomServiceStart-5" class="node statediagram-state"><rect height="34" width="155.84375" y="-17" x="-77.921875" style="" class="basic label-container"></rect><g transform="translate(-70.421875, -9.5)" style="" class="label"><foreignobject height="19" width="140.84375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">randomServiceStart</span></div></foreignobject></g></g></g></g><g transform="translate(217.4765625, 565)" id="state-CreateAnotherObjectGroup-7" class="node statediagram-state"><rect height="34" width="211.625" y="-17" x="-105.8125" style="" class="basic label-container"></rect><g transform="translate(-98.3125, -9.5)" style="" class="label"><foreignobject height="19" width="196.625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">CreateAnotherObjectGroup</span></div></foreignobject></g></g><g transform="translate(8.265625, 624)" class="root"><g class="clusters"><g id="ThirdInjector" class="statediagram-state statediagram-cluster"><rect height="104" width="403.421875" y="8" x="8" class="outer"></rect><g transform="translate(162.4140625, 8)" class="cluster-label"><foreignobject height="19" width="94.59375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">ThirdInjector</span></div></foreignobject></g><rect height="82" width="403.421875" y="26" x="8" class="inner"></rect></g></g><g class="edgePaths"><path marker-end="url(#statediagram-barbEnd)" style="fill:none" class="edge-thickness-normal transition" id="edge8" d="M196.109375,60L200.27604166666666,60C204.44270833333334,60,212.77604166666666,60,221.109375,60C229.44270833333334,60,237.77604166666666,60,241.94270833333334,60L246.109375,60"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"></rect><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g></g><g class="nodes"><g transform="translate(114.5546875, 60)" id="state-createChildInjector2-8" class="node statediagram-state"><rect height="34" width="163.109375" y="-17" x="-81.5546875" style="" class="basic label-container"></rect><g transform="translate(-74.0546875, -9.5)" style="" class="label"><foreignobject height="19" width="148.109375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">createChildInjector2</span></div></foreignobject></g></g><g transform="translate(316.265625, 60)" id="state-otherServiceStart-8" class="node statediagram-state"><rect height="34" width="140.3125" y="-17" x="-70.15625" style="" class="basic label-container"></rect><g transform="translate(-62.65625, -9.5)" style="" class="label"><foreignobject height="19" width="125.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">otherServiceStart</span></div></foreignobject></g></g></g></g><g transform="translate(217.4765625, 803)" id="state-CreateEvenMoreObjects-10" class="node statediagram-state"><rect height="34" width="186.78125" y="-17" x="-93.390625" style="" class="basic label-container"></rect><g transform="translate(-85.890625, -9.5)" style="" class="label"><foreignobject height="19" width="171.78125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">CreateEvenMoreObjects</span></div></foreignobject></g></g><g transform="translate(217.4765625, 887)" id="state-finalServiceGroup-11" class="node statediagram-state"><rect height="34" width="142.3125" y="-17" x="-71.15625" style="" class="basic label-container"></rect><g transform="translate(-63.65625, -9.5)" style="" class="label"><foreignobject height="19" width="127.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">finalServiceGroup</span></div></foreignobject></g></g><g transform="translate(217.4765625, 961)" id="state-root_end-11" class="node default"><circle height="14" width="14" r="7" class="state-start"></circle><circle height="10" width="10" r="5" class="state-end"></circle></g></g></g></g><style>@import url("https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css");</style></svg><p>This proved to be moderately disastrous as an approach:</p>
<ol>
<li>This made it <em>extremely</em> difficult to test. The construction process become fragile and any change to ordering or system construction would cause the test harness to break.</li>
<li>Because some steps depended on the initialization of previous steps, it meant that you almost couldn’t use a <a href="https://github.com/google/guava/wiki/ServiceExplained">ServiceManager</a> and were instead stuck with initializing every service manually.</li>
<li>It became very difficult for engineers who weren’t extremely familiar with the ins and outs of guice to modify the system in any way, which was the opposite of what was desired.</li>
</ol>
<h4 id="privatemodule">
<span class="mr-2">PrivateModule</span><a href="#privatemodule" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h4>
<p>When we first started, we used <code class="language-plaintext highlighter-rouge">PrivateModule</code>s to strictly segment the code areas. This way the packages very rarely impacted each other. Over time, it was recognized that this was not ideal.</p>
<ol>
<li>
<code class="language-plaintext highlighter-rouge">PrivateModule</code> did not work with a lot of the tooling that makes it easier to debug, visualize, or test guice.</li>
<li>It ended up making it harder to share certain key, central resources that were already shared. It became challenging to know whether it was more appropriate to declare a resource in the private module or in a higher level module, or to <em>find</em> resources that might be useful that had already been bound somewhere.</li>
<li>It added another layer of conceptual complexity to an already complex system.</li>
</ol>
<p>In the end, we did away with virtually all of the private modules, moving instead to binding annotations/qualifiers instead.</p>
<h4 id="testing-moving-ahead-of-refactoring">
<span class="mr-2">Testing Moving Ahead of Refactoring</span><a href="#testing-moving-ahead-of-refactoring" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h4>
<p>In several cases testing moved ahead of refactoring, requiring us to break and fix a large body of tests that had been written to try to solve the incredibly weird problem. This was especially true when we had started from the bottom up, but it remained a problem until we had finalized the changes.</p>
<p>Luckily, the testing group was completey on board with our work, so it made it an easy sell in a lot of ways, but it still meant there was some avoidable churn in how we went about it.</p>
<h4 id="is-that-a-singleton">
<span class="mr-2">Is That a Singleton?</span><a href="#is-that-a-singleton" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h4>
<p>Guice likes to deemphasize the use of singletons—for good reasons—when they aren’t absolutely required. This had… odd interfacing with some of the elements of the system that depended on something being a singleton and never documented it.</p>
<p>This was particularly challenging for sets of objects that depended on shared locks (yes, this was a thing), where the object had some slow memory leak that hadn’t been previously detected, or where a singleton was being used as a memory control. In these cases there was no obvious reason why a singleton was the right choice–and sometimes it was in fact the wrong choice–but Bad Things™ would happen from removing that conceit from the system.</p>
<p>This was also challenging because a lot of bugs could crop up that were very subtle as a result of these sorts of conceits. To catch these we had to do a lot of work with load testing, because the problems would only manifest under load.</p>
<h2 id="conclusion">
<span class="mr-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h2>
<p>Ultimately the project was what I’d term successful: we got the system into a stable, testable, state. It was in many way</p>
<p>So that’s me getting the story of how we tore apart the central conceit of a system out of <em>my</em> system.</p>
<h2 id="references">
<span class="mr-2">References</span><a href="#references" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h2>
<div class="bibliography"><p> [1]   <span id="law-of-demeter">K. J. Lieberherr, I. Holland, and A. J. Riel, “Object-Oriented Programming: An Objective Sense of Style,” <i>SIGPLAN Notices</i>, vol. 23, no. 11, pp. 323–334, Jan. 1988,</span> doi: <a href="https://doi.org/10.1145/62084.62113" target="_blank" rel="noreferrer noopener">10.1145/62084.62113</a>. [<a href="https://www2.ccs.neu.edu/research/demeter/papers/law-of-demeter/oopsla88-law-of-demeter.pdf" target="_blank" rel="noreferrer noopener">Online</a>; accessed on 25 April 2022]</p></div>
</div>
<div class="post-meta text-muted d-flex"><div class="mr-auto"> <i class="far fa-calendar fa-fw"></i> <em class="timeago" data-ts="1651302000" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" data-capitalize="true"> 2022-04-30 </em> <i class="far fa-clock fa-fw"></i> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2778 words"> <em>15 min</em></span> <i class="far fa-folder-open fa-fw"></i> <span> technology, programming </span>
</div></div>
<ul class="pagination align-items-center mt-4 mb-0 pl-lg-2">
<li class="page-item "> <a class="page-link btn-box-shadow" href="/" aria-label="prvious-page"> <i class="fas fa-angle-left"></i> </a>
</li>
<li class="page-item "> <a class="page-link btn-box-shadow" href="/">1</a>
</li>
<li class="page-item active"> <a class="page-link btn-box-shadow" href="/posts/page/2/">2</a>
</li>
<li class="page-item "> <a class="page-link btn-box-shadow" href="/posts/page/3/">3</a>
</li>
<li class="page-item disabled"> <span class="page-link btn-box-shadow">...</span>
</li>
<li class="page-item "> <a class="page-link btn-box-shadow" href="/posts/page/7/">7</a>
</li>
<li class="page-index align-middle"> <span>2</span> <span class="text-muted">/ 7</span>
</li>
<li class="page-item "> <a class="page-link btn-box-shadow" href="/posts/page/3" aria-label="next-page"> <i class="fas fa-angle-right"></i> </a>
</li>
</ul>
</div></div>
<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-tags">
<div class="panel-heading">Trending Tags</div>
<div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/engineering/">engineering</a> <a class="post-tag" href="/tags/abortion/">abortion</a> <a class="post-tag" href="/tags/agriculture/">agriculture</a> <a class="post-tag" href="/tags/boycotts/">boycotts</a> <a class="post-tag" href="/tags/debugging/">debugging</a> <a class="post-tag" href="/tags/first-post/">first-post</a> <a class="post-tag" href="/tags/github/">github</a> <a class="post-tag" href="/tags/gitpod/">gitpod</a> <a class="post-tag" href="/tags/goals/">goals</a> <a class="post-tag" href="/tags/jekyll/">jekyll</a>
</div>
</div></div></div>
</div>
<footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted">
<div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/dclements">DHC</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Attribution-NoDerivatives 4.0 International (CC BY ND 4.0) License by the author.">Some rights reserved.</span></p></div>
<div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div>
</div></footer>
</div>
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content">
<div id="search-hints"><div id="access-tags">
<div class="panel-heading">Trending Tags</div>
<div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/engineering/">engineering</a> <a class="post-tag" href="/tags/abortion/">abortion</a> <a class="post-tag" href="/tags/agriculture/">agriculture</a> <a class="post-tag" href="/tags/boycotts/">boycotts</a> <a class="post-tag" href="/tags/debugging/">debugging</a> <a class="post-tag" href="/tags/first-post/">first-post</a> <a class="post-tag" href="/tags/github/">github</a> <a class="post-tag" href="/tags/gitpod/">gitpod</a> <a class="post-tag" href="/tags/goals/">goals</a> <a class="post-tag" href="/tags/jekyll/">jekyll</a>
</div>
</div></div>
<div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
</div></div>
</div>
<div id="mask"></div>
<a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script defer src="/assets/js/dist/commons.min.js"></script> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-2PPSJLGZ1F"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-2PPSJLGZ1F'); }); </script>
</body>
</html>
